<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BGA-Trainer Pro</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f3f4f6;
    }
    
    .card {
      background-color: #ffffff;
      border-radius: 12px;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      padding: 24px;
      margin-bottom: 20px;
    }
    
    .header {
      background: linear-gradient(90deg, #1e3a8a, #2563eb);
      color: white;
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 20px;
    }
    
    .bga-table {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
      gap: 16px;
    }
    
    .bga-item {
      position: relative;
      background-color: #f9fafb;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 12px;
      text-align: center;
    }
    .bga-item label {
      display: block;
      font-size: 0.875rem;
      color: #4b5563;
      font-weight: 500;
    }
    .bga-item input {
      font-size: 1.5rem;
      font-weight: 700;
      color: #111827;
      width: 100%;
      border: none;
      background: transparent;
      text-align: center;
      padding: 4px 0 0;
      outline: none;
    }
    
    .bga-item.norm-green { border-color: #10b981; background-color: #f0fdf4; }
    .bga-item.norm-red { border-color: #ef4444; background-color: #fef2f2; }
    .bga-item.norm-blue { border-color: #3b82f6; background-color: #eff6ff; }

    .tooltip {
      position: absolute;
      top: 2px;
      right: 5px;
      cursor: help;
      color: #9ca3af;
    }
    .tooltip .tooltip-text {
      visibility: hidden;
      width: 220px;
      background-color: #111827;
      color: #fff;
      text-align: left;
      border-radius: 6px;
      padding: 8px;
      position: absolute;
      z-index: 10;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 0.75rem;
    }
    .tooltip:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
    }
    
    .response-list {
      list-style-type: none;
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
    }
    @media (min-width: 640px) {
      .response-list.two-col {
        grid-template-columns: 1fr 1fr;
      }
    }
    
    .response-list li {
      margin: 0;
    }
    .response-list input[type="radio"] {
      display: none;
    }
    .response-list label {
      display: block;
      padding: 16px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      background-color: #f3f4f6;
      color: #374151;
      cursor: pointer;
      transition: all 0.2s ease;
      font-weight: 500;
    }
    
    .response-list input[type="radio"]:checked + label {
      background-color: #3b82f6;
      color: white;
      border-color: #2563eb;
    }
    
    .response-list input[type="radio"]:disabled + label,
    fieldset:disabled .response-list label {
        background-color: #f3f4f6;
        color: #9ca3af;
        cursor: not-allowed;
        border-color: #e5e7eb;
    }

    .btn {
      padding: 12px 20px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
    }
    .btn-primary {
      background-color: #2563eb;
      color: white;
    }
    .btn-primary:hover {
      background-color: #1d4ed8;
    }
    .btn-secondary {
      background-color: #e5e7eb;
      color: #374151;
    }
    .btn-secondary:hover {
      background-color: #d1d5db;
    }

    .mode-switch {
      display: flex;
      border-radius: 8px;
      background-color: #e5e7eb;
      padding: 4px;
      width: fit-content;
    }
    .mode-switch input[type="radio"] {
      display: none;
    }
    .mode-switch label {
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      color: #4b5563;
      transition: all 0.2s ease;
    }
    .mode-switch input[type="radio"]:checked + label {
      background-color: #ffffff;
      color: #111827;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    details {
      background-color: #f9fafb;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      margin-bottom: 16px;
    }
    details summary {
      padding: 16px;
      cursor: pointer;
      font-weight: 600;
      color: #1f2937;
      list-style: none;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    details summary::-webkit-details-marker {
      display: none;
    }
    details .content {
      padding: 0 16px 16px;
      border-top: 1px solid #e5e7eb;
    }
    
    .clinical-explanation {
      background-color: #eff6ff;
      border: 1px solid #3b82f6;
      border-radius: 8px;
      padding: 16px;
      margin-top: 16px;
    }
    .clinical-explanation h4 {
      margin: 0 0 8px;
      color: #1e40af;
      font-size: 0.95rem;
    }
    .clinical-explanation p {
      margin: 0 0 8px;
      font-size: 0.875rem;
      line-height: 1.5;
    }
    
    .hidden {
      display: none;
    }
    
    /* Sprint 2: Dashboard Styles */
    .stats-section {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
    }
    
    .stats-section h3 {
      margin: 0 0 12px 0;
      font-size: 1.1rem;
      font-weight: 600;
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 12px;
    }
    
    .stat-item {
      background: rgba(255, 255, 255, 0.15);
      padding: 12px;
      border-radius: 6px;
    }
    
    .stat-label {
      font-size: 0.85rem;
      opacity: 0.9;
      margin-bottom: 4px;
    }
    
    .stat-value {
      font-size: 1.5rem;
      font-weight: 700;
    }
    
    .progress-bar-container {
      background: rgba(255, 255, 255, 0.2);
      height: 24px;
      border-radius: 12px;
      overflow: hidden;
      margin: 8px 0;
      position: relative;
    }
    
    .progress-bar {
      height: 100%;
      transition: width 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      font-weight: 600;
    }
    
    .progress-bar.excellent { background: #10b981; }
    .progress-bar.good { background: #f59e0b; }
    .progress-bar.needs-work { background: #ef4444; }
    
    .recommendation-card {
      background: rgba(255, 255, 255, 0.15);
      border-left: 4px solid #fbbf24;
      padding: 12px;
      border-radius: 6px;
      margin-bottom: 12px;
    }
    
    .recommendation-card h4 {
      margin: 0 0 6px 0;
      font-size: 0.95rem;
    }
    
    .recommendation-card p {
      margin: 0;
      font-size: 0.85rem;
      opacity: 0.9;
    }

  </style>
</head>
<body class="p-4 md:p-8">

  <div class="max-w-3xl mx-auto">
    
    <header class="header">
      <div class="flex justify-between items-center">
        <h1 class="text-xl md:text-2xl font-bold">BGA-Trainer Pro</h1>
        <div class="flex gap-2 items-center">
          <div id="progress-badge" class="bg-white/20 text-white text-xs font-semibold px-3 py-1 rounded-full cursor-help" title="Klicken f√ºr Details">
            <span id="progress-text">Lade...</span>
          </div>
          <div id="mode-chip" class="bg-white/20 text-white text-xs font-semibold px-3 py-1 rounded-full">
            BASIS MODUS
          </div>
        </div>
      </div>
      <p class="text-sm text-white/80 mt-2">Systematisches BGA-Training f√ºr die Intensivpflege</p>
    </header>

    <div class="card flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
      <div>
        <h2 class="text-lg font-semibold text-gray-800 m-0">Lern-Modus</h2>
        <p class="text-gray-600 m-0 text-sm">W√§hle deinen Erfahrungsgrad.</p>
      </div>
      <div class="flex gap-3 items-center flex-wrap">
        <div class="mode-switch">
          <input type="radio" id="mode-basic" name="mode" value="basic" checked>
          <label for="mode-basic">Basis</label>
          <input type="radio" id="mode-advanced" name="mode" value="advanced">
          <label for="mode-advanced">Advanced</label>
          <input type="radio" id="mode-mixed" name="mode" value="mixed">
          <label for="mode-mixed">Mixed</label>
        </div>
        <button id="stats-toggle-btn" class="btn btn-secondary text-sm py-2 px-3" title="Zeige detaillierte Lernstatistiken">
          üìä Statistiken
        </button>
      </div>
    </div>

    <!-- Dashboard Panel (initially hidden) -->
    <div id="stats-dashboard" class="card hidden" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-bold m-0">üìä Deine Lernstatistiken</h2>
        <button id="stats-close-btn" class="text-white hover:text-gray-200 text-2xl font-bold" style="background: none; border: none; cursor: pointer;" title="Schlie√üen">&times;</button>
      </div>
      
      <div id="stats-content" class="space-y-4">
        <!-- Wird dynamisch gef√ºllt -->
      </div>
    </div>

    <div class="card">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-lg font-semibold text-gray-800 m-0">
          Fall #<span id="case-id">1</span>
        </h2>
        <span id="case-complexity" class="text-xs px-2 py-1 rounded-full bg-green-100 text-green-800"></span>
      </div>

      <div id="clinical-context" class="mb-4 p-3 bg-blue-50 border-l-4 border-blue-500 text-sm text-gray-700 rounded">
        Klinischer Kontext wird hier angezeigt...
      </div>

      <h3 class="text-base font-semibold text-gray-700 mb-3">Grundwerte</h3>
      <div class="bga-table mb-4">
        <div class="bga-item" id="item-ph">
          <label for="ph">pH</label>
          <input type="number" id="ph" step="0.01" value="7.40" readonly>
          <div class="tooltip">?
            <span class="tooltip-text">S√§ure-Basen-Status. Niedrig = Azidose, Hoch = Alkalose.</span>
          </div>
        </div>
        <div class="bga-item" id="item-pco2">
          <label for="pco2">pCO‚ÇÇ (mmHg)</label>
          <input type="number" id="pco2" step="0.1" value="40.0" readonly>
          <div class="tooltip">?
            <span class="tooltip-text">Respiratorischer Parameter.</span>
          </div>
        </div>
        <div class="bga-item" id="item-hco3">
          <label for="hco3">HCO‚ÇÉ‚Åª (mmol/L)</label>
          <input type="number" id="hco3" step="0.1" value="24.0" readonly>
          <div class="tooltip">?
            <span class="tooltip-text">Metabolischer Parameter.</span>
          </div>
        </div>
        <div class="bga-item" id="item-be">
          <label for="be">BE (mmol/L)</label>
          <input type="number" id="be" step="0.1" value="0.0" readonly>
          <div class="tooltip">?
            <span class="tooltip-text">Base Excess.</span>
          </div>
        </div>
      </div>

      <div id="advanced-values-container" class="hidden">
        <h3 class="text-base font-semibold text-gray-700 mb-3">Erweiterte Werte</h3>
        <div class="bga-table">
          <div class="bga-item" id="item-laktat">
            <label for="laktat">Laktat (mmol/L)</label>
            <input type="number" id="laktat" step="0.1" value="1.0" readonly>
          </div>
          <div class="bga-item" id="item-na">
            <label for="na">Na‚Å∫ (mmol/L)</label>
            <input type="number" id="na" step="1" value="140" readonly>
          </div>
          <div class="bga-item" id="item-cl">
            <label for="cl">Cl‚Åª (mmol/L)</label>
            <input type="number" id="cl" step="1" value="105" readonly>
          </div>
          <div class="bga-item" id="item-k">
            <label for="k">K‚Å∫ (mmol/L)</label>
            <input type="number" id="k" step="0.1" value="4.0" readonly>
          </div>
          <div class="bga-item" id="item-glukose">
            <label for="glukose">Glukose (mg/dL)</label>
            <input type="number" id="glukose" step="1" value="100" readonly>
          </div>
        </div>
      </div>
      
    </div>
    
    <details>
      <summary>Normwerte (Spickzettel)</summary>
      <div class="content text-sm text-gray-700">
        <ul class="list-disc pl-5 space-y-1">
          <li><strong>pH:</strong> 7.35 ‚Äì 7.45</li>
          <li><strong>pCO‚ÇÇ:</strong> 35 ‚Äì 45 mmHg</li>
          <li><strong>HCO‚ÇÉ‚Åª:</strong> 22 ‚Äì 26 mmol/L</li>
          <li><strong>BE:</strong> -2 ‚Äì +2 mmol/L</li>
          <li><strong>Laktat:</strong> 0.5 ‚Äì 2.0 mmol/L</li>
          <li><strong>Na‚Å∫:</strong> 135 ‚Äì 145 mmol/L</li>
          <li><strong>Cl‚Åª:</strong> 98 ‚Äì 108 mmol/L</li>
          <li><strong>K‚Å∫:</strong> 3.5 ‚Äì 5.0 mmol/L</li>
          <li><strong>Glukose:</strong> 70 ‚Äì 110 mg/dL</li>
        </ul>
        <p class="mt-2 text-xs text-gray-500">Beachte: Normwerte k√∂nnen je nach Labor leicht abweichen.</p>
      </div>
    </details>

    <div class="card">
      <h2 class="text-lg font-semibold text-gray-800 m-0 mb-4">1. Prim√§re St√∂rung</h2>
      <fieldset id="primary-fieldset">
        <ul class="response-list two-col">
          <li><input type="radio" id="p-normal" name="primary" value="NORMAL"><label for="p-normal">Normal</label></li>
          <li><input type="radio" id="p-resp-aci" name="primary" value="RESP_ACI"><label for="p-resp-aci">Respiratorische Azidose</label></li>
          <li><input type="radio" id="p-resp-alk" name="primary" value="RESP_ALK"><label for="p-resp-alk">Respiratorische Alkalose</label></li>
          <li><input type="radio" id="p-met-aci" name="primary" value="MET_ACI"><label for="p-met-aci">Metabolische Azidose</label></li>
          <li><input type="radio" id="p-met-alk" name="primary" value="MET_ALK"><label for="p-met-alk">Metabolische Alkalose</label></li>
          <li id="p-mixed-li" class="hidden"><input type="radio" id="p-mixed" name="primary" value="P_MIXED"><label for="p-mixed">Gemischte St√∂rung</label></li>
        </ul>
      </fieldset>
    </div>

    <div class="card">
      <fieldset id="comp-basic-fieldset" disabled>
        <legend class="text-lg font-semibold text-gray-800 m-0 mb-4">2. Kompensation (Basis)</legend>
        <ul class="response-list">
          <li><input type="radio" id="c-none" name="comp_basic" value="NONE"><label for="c-none">Keine Kompensation</label></li>
          <li><input type="radio" id="c-partial" name="comp_basic" value="PARTIAL"><label for="c-partial">Teilweise kompensiert</label></li>
          <li><input type="radio" id="c-full" name="comp_basic" value="FULL"><label for="c-full">Vollst√§ndig kompensiert</label></li>
        </ul>
      </fieldset>
      
      <fieldset id="comp-advanced-fieldset" class="hidden" disabled>
        <legend class="text-lg font-semibold text-gray-800 m-0 mb-4">2. Kompensations-Analyse (Advanced)</legend>
        <ul class="response-list two-col">
          <li><input type="radio" id="ca-none" name="comp_advanced" value="NONE"><label for="ca-none">Keine Kompensation</label></li>
          <li><input type="radio" id="ca-resp-partial" name="comp_advanced" value="RESP_PARTIAL"><label for="ca-resp-partial">Respiratorische Teil-Komp.</label></li>
          <li><input type="radio" id="ca-met-partial" name="comp_advanced" value="MET_PARTIAL"><label for="ca-met-partial">Metabolische Teil-Komp.</label></li>
          <li><input type="radio" id="ca-resp-full" name="comp_advanced" value="RESP_FULL"><label for="ca-resp-full">Respiratorische Voll-Komp.</label></li>
          <li><input type="radio" id="ca-met-full" name="comp_advanced" value="MET_FULL"><label for="ca-met-full">Metabolische Voll-Komp.</label></li>
          <li><input type="radio" id="ca-mixed" name="comp_advanced" value="C_MIXED"><label for="ca-mixed">Gemischte St√∂rung</label></li>
        </ul>
      </fieldset>
    </div>

    <div class="card">
      <details id="explain-wrap" class="mb-4">
        <summary>
          <div class="flex items-center">
            <span id="status-dot" style="display:inline-block;width:12px;height:12px;border-radius:50%;margin-right:8px;background-color:#9ca3af;"></span>
            <span id="result-text">Bitte Werte auswerten</span>
          </div>
        </summary>
        <div class="content text-sm text-gray-700" id="explanation">
          Bitte w√§hle eine prim√§re St√∂rung und die Kompensation aus.
        </div>
      </details>
      
      <div id="clinical-explanation-container" class="hidden">
        <div class="clinical-explanation">
          <h4>üéì Klinische Bedeutung</h4>
          <div id="clinical-explanation-text"></div>
        </div>
      </div>

      <div class="flex flex-wrap gap-3 mt-4">
        <button id="evalbutton" class="btn btn-primary flex-1">Auswerten</button>
        <button id="resetbutton" class="btn btn-secondary">Zur√ºcksetzen</button>
        <button id="nextcasebutton" class="btn btn-secondary">N√§chster Fall</button>
      </div>
      
    </div>

  </div>

  <footer class="max-w-3xl mx-auto text-center text-xs text-gray-500 mt-8 mb-4 px-4">
    <p><strong>Wichtiger Hinweis (Haftungsausschluss):</strong><br>
    Dieses Tool dient ausschlie√ülich zu √úbungs- und Schulungszwecken. Die dargestellten F√§lle, Werte und Erkl√§rungen sind nicht zur Stellung medizinischer Diagnosen oder als Ersatz f√ºr professionellen medizinischen Rat, eine Diagnose oder eine Behandlung gedacht. Die Nutzung erfolgt auf eigene Gefahr. Es wird keine Haftung f√ºr die Richtigkeit oder Vollst√§ndigkeit der Inhalte √ºbernommen.</p>
    <p class="mt-4 text-gray-400" style="font-size: 0.65rem;">Version 1.1 | Sprint 1 Complete | <span id="dev-mode" style="cursor: help;" title="Shift+Klick f√ºr Entwickler-Optionen">üîß</span></p>
  </footer>

  <script>
    // Developer Mode: Shift+Klick auf Dev-Icon zeigt Reset-Option
    document.getElementById('dev-mode').addEventListener('click', function(e) {
      if (e.shiftKey) {
        const stats = LearningManager.getBasicStats();
        const confirmMsg = `üîß ENTWICKLER-MODUS\n\n`;
        const confirmMsg2 = `Aktueller Speicher:\n`;
        const confirmMsg3 = `‚Ä¢ ${stats.totalAttempts} gespeicherte Versuche\n`;
        const confirmMsg4 = `‚Ä¢ ${stats.uniqueCasesWorked} verschiedene F√§lle\n\n`;
        const confirmMsg5 = `M√∂chtest du alle Daten l√∂schen?\n`;
        const confirmMsg6 = `(Nur f√ºr Testing/Entwicklung)`;
        
        if (confirm(confirmMsg + confirmMsg2 + confirmMsg3 + confirmMsg4 + confirmMsg5 + confirmMsg6)) {
          if (LearningManager.reset()) {
            updateProgressBadge();
            alert('‚úì Lernfortschritt wurde zur√ºckgesetzt.');
            location.reload();
          }
        }
      } else {
        alert('üí° Tipp: Shift+Klick f√ºr Entwickler-Optionen');
      }
    });

    const NORMBEREICHE = {
      ph: { min: 7.35, max: 7.45 },
      pco2: { min: 35, max: 45 },
      hco3: { min: 22, max: 26 },
      be: { min: -2, max: 2 },
      laktat: { min: 0.5, max: 2.0 },
      na: { min: 135, max: 145 },
      cl: { min: 98, max: 108 },
      k: { min: 3.5, max: 5.0 },
      glukose: { min: 70, max: 110 }
    };

    // ========================================
    // LEARNING MANAGER - Sprint 1: Persistenz & Basis-Tracking
    // ========================================
    const LearningManager = {
      STORAGE_KEY: 'bga_trainer_learning_profile',
      
      // Initialisiert das Learning Profile oder l√§dt existierendes
      init() {
        const stored = localStorage.getItem(this.STORAGE_KEY);
        if (stored) {
          try {
            this.profile = JSON.parse(stored);
            // Sicherstellen dass die Struktur korrekt ist (f√ºr Updates)
            if (!this.profile.attempts) this.profile.attempts = [];
            if (!this.profile.startedAt) this.profile.startedAt = new Date().toISOString();
          } catch (e) {
            console.error('Fehler beim Laden des Profils, erstelle neues:', e);
            this.createNewProfile();
          }
        } else {
          this.createNewProfile();
        }
        return this.profile;
      },
      
      // Erstellt ein neues Learning Profile
      createNewProfile() {
        this.profile = {
          startedAt: new Date().toISOString(),
          attempts: [], // Array mit allen Versuchen
          totalCases: 0, // Anzahl bearbeiteter F√§lle
          correctCases: 0 // Anzahl richtig gel√∂ster F√§lle
        };
        this.save();
      },
      
      // Speichert einen neuen Versuch
      saveAttempt(caseId, selectedPrimary, selectedComp, correctPrimary, correctComp, mode) {
        const isCorrect = (selectedPrimary === correctPrimary && selectedComp === correctComp);
        
        const attempt = {
          caseId: caseId,
          timestamp: new Date().toISOString(),
          selectedPrimary: selectedPrimary,
          selectedComp: selectedComp,
          correctPrimary: correctPrimary,
          correctComp: correctComp,
          isCorrect: isCorrect,
          mode: mode,
          // Fehlertyp-Analyse f√ºr Sprint 2
          errorType: this.analyzeError(selectedPrimary, selectedComp, correctPrimary, correctComp)
        };
        
        this.profile.attempts.push(attempt);
        this.profile.totalCases++;
        if (isCorrect) this.profile.correctCases++;
        
        this.save();
        return isCorrect;
      },
      
      // Analysiert die Art des Fehlers (Basis f√ºr Sprint 2)
      analyzeError(selPrimary, selComp, corPrimary, corComp) {
        if (selPrimary === corPrimary && selComp === corComp) return 'none';
        if (selPrimary !== corPrimary && selComp !== corComp) return 'both';
        if (selPrimary !== corPrimary) return 'primary';
        if (selComp !== corComp) return 'compensation';
        return 'unknown';
      },
      
      // Speichert das Profil in LocalStorage
      save() {
        try {
          localStorage.setItem(this.STORAGE_KEY, JSON.stringify(this.profile));
        } catch (e) {
          console.error('Fehler beim Speichern:', e);
          // LocalStorage k√∂nnte voll sein oder Browser erlaubt es nicht
          alert('Warnung: Dein Fortschritt konnte nicht gespeichert werden. M√∂glicherweise ist der Browser-Speicher voll.');
        }
      },
      
      // Gibt Basis-Statistiken zur√ºck
      getBasicStats() {
        const total = this.profile.totalCases;
        const correct = this.profile.correctCases;
        const percentage = total > 0 ? Math.round((correct / total) * 100) : 0;
        
        // Berechne wie viele verschiedene F√§lle bearbeitet wurden
        const uniqueCases = new Set(this.profile.attempts.map(a => a.caseId)).size;
        
        // Finde letzte Session (Versuche der letzten 2 Stunden)
        const twoHoursAgo = new Date(Date.now() - 2 * 60 * 60 * 1000);
        const recentAttempts = this.profile.attempts.filter(a => 
          new Date(a.timestamp) > twoHoursAgo
        );
        
        return {
          totalAttempts: total,
          correctAttempts: correct,
          successRate: percentage,
          uniqueCasesWorked: uniqueCases,
          recentSessionSize: recentAttempts.length,
          startedAt: this.profile.startedAt
        };
      },
      
      // L√∂scht das Profil (f√ºr Testing oder Neustart)
      reset() {
        if (confirm('M√∂chtest du wirklich deinen gesamten Lernfortschritt l√∂schen? Diese Aktion kann nicht r√ºckg√§ngig gemacht werden.')) {
          localStorage.removeItem(this.STORAGE_KEY);
          this.createNewProfile();
          return true;
        }
        return false;
      },
      
      // ========================================
      // SPRINT 2: Erweiterte Analyse-Methoden
      // ========================================
      
      // Analysiert Performance nach St√∂rungstypen
      getPerformanceByDisorder() {
        const disorders = {
          'NORMAL': { total: 0, correct: 0, label: 'Normal' },
          'RESP_ACI': { total: 0, correct: 0, label: 'Respiratorische Azidose' },
          'RESP_ALK': { total: 0, correct: 0, label: 'Respiratorische Alkalose' },
          'MET_ACI': { total: 0, correct: 0, label: 'Metabolische Azidose' },
          'MET_ALK': { total: 0, correct: 0, label: 'Metabolische Alkalose' },
          'P_MIXED': { total: 0, correct: 0, label: 'Gemischte St√∂rung' }
        };
        
        this.profile.attempts.forEach(attempt => {
          const correctType = attempt.correctPrimary;
          if (disorders[correctType]) {
            disorders[correctType].total++;
            if (attempt.isCorrect) {
              disorders[correctType].correct++;
            }
          }
        });
        
        // Berechne Prozents√§tze und sortiere nach H√§ufigkeit
        const result = [];
        for (const key in disorders) {
          if (disorders[key].total > 0) {
            const percentage = Math.round((disorders[key].correct / disorders[key].total) * 100);
            result.push({
              type: key,
              label: disorders[key].label,
              total: disorders[key].total,
              correct: disorders[key].correct,
              percentage: percentage,
              status: percentage >= 80 ? 'excellent' : percentage >= 60 ? 'good' : 'needs-work'
            });
          }
        }
        
        // Sortiere nach Anzahl der Versuche (h√§ufigste zuerst)
        result.sort((a, b) => b.total - a.total);
        return result;
      },
      
      // Analysiert Fehlertypen (Prim√§rst√∂rung vs Kompensation)
      getErrorTypeAnalysis() {
        const errorTypes = {
          'none': 0,        // Alles richtig
          'primary': 0,     // Nur Prim√§rst√∂rung falsch
          'compensation': 0, // Nur Kompensation falsch
          'both': 0         // Beides falsch
        };
        
        this.profile.attempts.forEach(attempt => {
          const type = attempt.errorType || 'unknown';
          if (errorTypes.hasOwnProperty(type)) {
            errorTypes[type]++;
          }
        });
        
        const total = this.profile.attempts.length;
        
        return {
          primaryErrors: errorTypes.primary,
          compensationErrors: errorTypes.compensation,
          bothErrors: errorTypes.both,
          totalErrors: errorTypes.primary + errorTypes.compensation + errorTypes.both,
          primaryErrorRate: total > 0 ? Math.round((errorTypes.primary / total) * 100) : 0,
          compensationErrorRate: total > 0 ? Math.round((errorTypes.compensation / total) * 100) : 0,
          bothErrorRate: total > 0 ? Math.round((errorTypes.both / total) * 100) : 0,
          // Diagnose wo das gr√∂√üte Problem liegt
          mainWeakness: errorTypes.primary > errorTypes.compensation ? 'primary' : 
                       errorTypes.compensation > errorTypes.primary ? 'compensation' : 
                       errorTypes.both > 0 ? 'both' : 'none'
        };
      },
      
      // Erkennt Verwechslungsmuster
      getConfusionPatterns() {
        const confusions = {};
        
        this.profile.attempts.forEach(attempt => {
          if (!attempt.isCorrect && attempt.selectedPrimary !== attempt.correctPrimary) {
            const key = `${attempt.correctPrimary}_to_${attempt.selectedPrimary}`;
            if (!confusions[key]) {
              confusions[key] = {
                correct: attempt.correctPrimary,
                selected: attempt.selectedPrimary,
                count: 0
              };
            }
            confusions[key].count++;
          }
        });
        
        // Konvertiere zu Array und sortiere nach H√§ufigkeit
        const patterns = Object.values(confusions).sort((a, b) => b.count - a.count);
        
        // Gib nur die h√§ufigsten Verwechslungen zur√ºck (mindestens 2x)
        return patterns.filter(p => p.count >= 2).slice(0, 5);
      },
      
      // Analysiert zeitlichen Trend (Verbesserung oder Stagnation)
      getTrendAnalysis() {
        const attempts = this.profile.attempts;
        const total = attempts.length;
        
        if (total < 10) {
          return {
            available: false,
            message: 'Noch zu wenig Daten f√ºr Trendanalyse (mindestens 10 Versuche n√∂tig)'
          };
        }
        
        // Teile Versuche in zwei H√§lften
        const halfPoint = Math.floor(total / 2);
        const firstHalf = attempts.slice(0, halfPoint);
        const secondHalf = attempts.slice(halfPoint);
        
        const firstHalfCorrect = firstHalf.filter(a => a.isCorrect).length;
        const secondHalfCorrect = secondHalf.filter(a => a.isCorrect).length;
        
        const firstRate = Math.round((firstHalfCorrect / firstHalf.length) * 100);
        const secondRate = Math.round((secondHalfCorrect / secondHalf.length) * 100);
        const improvement = secondRate - firstRate;
        
        let trend, message;
        if (improvement >= 15) {
          trend = 'strong-improvement';
          message = 'Starke Verbesserung! Du lernst effektiv.';
        } else if (improvement >= 5) {
          trend = 'improvement';
          message = 'Gute Entwicklung! Du machst Fortschritte.';
        } else if (improvement >= -5) {
          trend = 'stable';
          message = 'Stabile Performance. Zeit f√ºr neue Herausforderungen?';
        } else {
          trend = 'declining';
          message = 'Leichter R√ºckgang. Vielleicht eine Pause einlegen?';
        }
        
        return {
          available: true,
          trend: trend,
          firstHalfRate: firstRate,
          secondHalfRate: secondRate,
          improvement: improvement,
          message: message
        };
      },
      
      // Findet die schwierigsten F√§lle f√ºr diesen User
      getHardestCases() {
        const casePerformance = {};
        
        // Sammle alle Versuche pro Fall
        this.profile.attempts.forEach(attempt => {
          if (!casePerformance[attempt.caseId]) {
            casePerformance[attempt.caseId] = {
              caseId: attempt.caseId,
              attempts: 0,
              correct: 0,
              lastAttempt: attempt.timestamp
            };
          }
          casePerformance[attempt.caseId].attempts++;
          if (attempt.isCorrect) {
            casePerformance[attempt.caseId].correct++;
          }
          // Aktualisiere letzten Versuch
          if (new Date(attempt.timestamp) > new Date(casePerformance[attempt.caseId].lastAttempt)) {
            casePerformance[attempt.caseId].lastAttempt = attempt.timestamp;
          }
        });
        
        // Konvertiere zu Array und berechne Erfolgsquote
        const cases = Object.values(casePerformance).map(c => ({
          ...c,
          successRate: c.attempts > 0 ? Math.round((c.correct / c.attempts) * 100) : 0
        }));
        
        // Finde die schwierigsten (niedrigste Erfolgsquote, mindestens 2 Versuche)
        const hardest = cases
          .filter(c => c.attempts >= 2 && c.successRate < 80)
          .sort((a, b) => a.successRate - b.successRate)
          .slice(0, 5);
        
        return hardest;
      },
      
      // Empfiehlt F√§lle basierend auf Schwachstellen
      getRecommendedCases() {
        const performance = this.getPerformanceByDisorder();
        const hardest = this.getHardestCases();
        
        const recommendations = [];
        
        // Empfehlung 1: Wiederhole schwierigste F√§lle
        if (hardest.length > 0) {
          recommendations.push({
            type: 'repeat-failed',
            title: 'Wiederhole schwierige F√§lle',
            description: `Du hast bei ${hardest.length} F√§llen Schwierigkeiten. Wiederholung festigt das Verst√§ndnis.`,
            caseIds: hardest.map(h => h.caseId)
          });
        }
        
        // Empfehlung 2: √úbe schwache St√∂rungstypen
        const weakDisorders = performance.filter(p => p.status === 'needs-work' && p.total >= 3);
        if (weakDisorders.length > 0) {
          const weakestDisorder = weakDisorders[0];
          recommendations.push({
            type: 'practice-weakness',
            title: `√úbe ${weakestDisorder.label}`,
            description: `Deine Erfolgsquote liegt hier bei ${weakestDisorder.percentage}%. Gezielte √úbung wird helfen.`,
            disorderType: weakestDisorder.type
          });
        }
        
        // Empfehlung 3: Neue F√§lle wenn Performance gut
        const stats = this.getBasicStats();
        if (stats.successRate >= 70 && stats.uniqueCasesWorked < CASES.length) {
          recommendations.push({
            type: 'explore-new',
            title: 'Probiere neue F√§lle',
            description: `Du machst es gut (${stats.successRate}%)! Zeit f√ºr neue Herausforderungen.`,
            caseIds: null
          });
        }
        
        return recommendations;
      }
    };

    const CASES = [
      {
        id: 1, mode: 'basic', complexity: 'Basis',
        context: '68-j√§hriger Patient mit bekannter COPD, zunehmende Dyspnoe seit 3 Tagen.',
        ph: 7.28, pco2: 62, hco3: 28, be: 2, laktat: 1.2, na: 140, cl: 104, k: 4.1, glukose: 105,
        primary: 'RESP_ACI', comp_basic: 'PARTIAL', comp_advanced: 'MET_PARTIAL',
        explanation: {
          pathophysiology: 'COPD-Exazerbation f√ºhrt zu CO2-Retention durch Bronchospasmus.',
          compensation: 'Nieren resorbieren vermehrt Bikarbonat. Dauert 3-5 Tage.',
          nursing: 'Atemerleichternde Lagerung, Vigilanz-Monitoring, NIV-Optimierung.'
        }
      },
      {
        id: 2, mode: 'basic', complexity: 'Basis',
        context: 'Postoperative Patientin, Opioide zur Schmerztherapie. Atemfrequenz 8/min.',
        ph: 7.25, pco2: 68, hco3: 24, be: -1, laktat: 1.0, na: 138, cl: 103, k: 3.9, glukose: 98,
        primary: 'RESP_ACI', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Opioide d√§mpfen das Atemzentrum, f√ºhren zu Hypoventilation.',
          compensation: 'Keine Kompensation bei akutem Ereignis.',
          nursing: 'SOFORT: Naloxon bereithalten, Atemfrequenz monitoren, O2-Gabe.'
        }
      },
      {
        id: 3, mode: 'basic', complexity: 'Basis',
        context: '52-j√§hriger Patient, BMI 48, chronische Hypoventilation.',
        ph: 7.36, pco2: 58, hco3: 32, be: 6, laktat: 1.1, na: 141, cl: 102, k: 4.2, glukose: 115,
        primary: 'RESP_ACI', comp_basic: 'FULL', comp_advanced: 'MET_FULL',
        explanation: {
          pathophysiology: 'Extreme Adipositas beeintr√§chtigt Atemmechanik.',
          compensation: 'Vollst√§ndige metabolische Kompensation, chronischer Zustand.',
          nursing: 'Schlafapnoe-Screening, NIV-Therapie, Gewichtsreduktion.'
        }
      },
      {
        id: 4, mode: 'basic', complexity: 'Basis',
        context: '32-j√§hrige Patientin, Panikattacke mit Kribbeln, Schwindel.',
        ph: 7.52, pco2: 28, hco3: 23, be: -1, laktat: 0.9, na: 140, cl: 105, k: 4.0, glukose: 98,
        primary: 'RESP_ALK', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Psychogene Hyperventilation bei Angst, CO2-Abatmung.',
          compensation: 'Akut, keine Zeit f√ºr Kompensation.',
          nursing: 'Beruhigende Gespr√§chsf√ºhrung, Atem√ºbungen. NICHT in T√ºte atmen!'
        }
      },
      {
        id: 5, mode: 'basic', complexity: 'Basis',
        context: 'Patient nach Appendektomie, starke Schmerzen, schnelle Atmung.',
        ph: 7.48, pco2: 32, hco3: 24, be: 0, laktat: 1.1, na: 139, cl: 104, k: 4.1, glukose: 110,
        primary: 'RESP_ALK', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Schmerz f√ºhrt zu Hyperventilation, CO2-Verlust.',
          compensation: 'Keine Kompensation, frische St√∂rung.',
          nursing: 'Schmerztherapie optimieren! Nach Schmerzlinderung normalisiert sich die Atmung.'
        }
      },
      {
        id: 6, mode: 'basic', complexity: 'Basis',
        context: '24-j√§hriger Diabetiker, Erbrechen, Insulin vergessen. BZ 420 mg/dl.',
        ph: 7.18, pco2: 28, hco3: 10, be: -15, laktat: 2.1, na: 135, cl: 98, k: 5.2, glukose: 420,
        primary: 'MET_ACI', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Insulinmangel f√ºhrt zu Ketonk√∂rper-Bildung, starke Azidose.',
          compensation: 'Kussmaul-Atmung versucht Kompensation.',
          nursing: 'NOTFALL! Volumengabe, Insulin-Perfusor, Kalium-Substitution, BZ-Kontrollen.'
        }
      },
      {
        id: 7, mode: 'basic', complexity: 'Basis',
        context: '72-j√§hrige nach Herzoperation, Urin unter 100ml/24h, Kreatinin 4.8.',
        ph: 7.28, pco2: 36, hco3: 16, be: -9, laktat: 1.5, na: 138, cl: 108, k: 5.8, glukose: 115,
        primary: 'MET_ACI', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Akutes Nierenversagen, S√§uren werden nicht ausgeschieden.',
          compensation: 'Keine Kompensation, akuter Prozess.',
          nursing: 'Bilanzierung, Fl√ºssigkeitsrestriktion, EKG-Monitoring wegen Hyperkali√§mie, Dialyse vorbereiten.'
        }
      },
      {
        id: 8, mode: 'basic', complexity: 'Basis',
        context: '45-j√§hriger mit Norovirus, √ºber 15 w√§ssrige Durchf√§lle pro Tag.',
        ph: 7.30, pco2: 35, hco3: 17, be: -8, laktat: 1.2, na: 136, cl: 112, k: 3.2, glukose: 95,
        primary: 'MET_ACI', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Bikarbonat-Verlust √ºber Darm, hyperchlor√§mische Azidose.',
          compensation: 'Noch keine Kompensation.',
          nursing: 'Volumengabe mit Elektrolytl√∂sungen, Kalium substituieren, Isolierung bei Norovirus.'
        }
      },
      {
        id: 9, mode: 'advanced', complexity: 'Advanced',
        context: 'Patient mit kardiogenem Schock, RR 75/50, kaltschwei√üig.',
        ph: 7.22, pco2: 32, hco3: 13, be: -12, laktat: 6.8, na: 138, cl: 104, k: 4.8, glukose: 185,
        primary: 'MET_ACI', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Schock f√ºhrt zu Gewebehypoxie, anaerober Stoffwechsel, Laktat-Akkumulation.',
          compensation: 'Teilweise respiratorisch, aber insuffizient.',
          nursing: 'KRITISCH! Volumengabe, Katecholamine, Laktat-Kontrollen, h√§modynamisches Monitoring.'
        }
      },
      {
        id: 10, mode: 'advanced', complexity: 'Advanced',
        context: 'Polytrauma, Milzruptur mit Schock, Hypothermie 34 Grad C.',
        ph: 7.08, pco2: 48, hco3: 14, be: -15, laktat: 9.2, na: 145, cl: 115, k: 5.8, glukose: 185,
        primary: 'MET_ACI', comp_basic: 'NONE', comp_advanced: 'C_MIXED',
        explanation: {
          pathophysiology: 'Letale Trias: Azidose plus Hypothermie plus Koagulopathie. Gemischte St√∂rung.',
          compensation: 'Keine Kompensation, zus√§tzliche respiratorische Azidose!',
          nursing: 'SCHWERSTVERLETZTER! Damage Control Surgery, Massivtransfusion, Wiedererw√§rmung, permissive Hypotension.'
        }
      },
      {
        id: 11, mode: 'basic', complexity: 'Basis',
        context: '24-j√§hrige Patientin mit schwerem Asthma-Anfall, stark dyspnoisch trotz Salbutamol.',
        ph: 7.22, pco2: 72, hco3: 25, be: -1, laktat: 1.3, na: 139, cl: 105, k: 3.7, glukose: 110,
        primary: 'RESP_ACI', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Beim schweren Asthma-Anfall f√ºhrt die massive Bronchialobstruktion zur Hypoventilation. Steigt der pCO‚ÇÇ an, ist dies ein Alarmzeichen f√ºr drohende Ersch√∂pfung.',
          compensation: 'Akute St√∂rung ohne Kompensation. Ein pCO‚ÇÇ √ºber 60 mmHg bei Asthma bedeutet drohende Atemersch√∂pfung und kann eine Intubationsindikation darstellen.',
          nursing: 'NOTFALL! Intensivmonitoring, Intubationsbereitschaft, hochdosierte Kortikosteroide und Bronchodilatatoren, Sauerstoff-Hochfluss, beruhigende Gespr√§chsf√ºhrung.'
        }
      },
      {
        id: 12, mode: 'basic', complexity: 'Basis',
        context: 'Patient mit ALS, progrediente Atemschw√§che, n√§chtliche Dyspnoe.',
        ph: 7.33, pco2: 54, hco3: 28, be: 2, laktat: 0.9, na: 140, cl: 103, k: 4.0, glukose: 95,
        primary: 'RESP_ACI', comp_basic: 'PARTIAL', comp_advanced: 'MET_PARTIAL',
        explanation: {
          pathophysiology: 'Bei ALS kommt es zur Degeneration der motorischen Neuronen mit progredienter Schw√§che der Atemmuskulatur. Die Pumpfunktion der Lunge wird beeintr√§chtigt.',
          compensation: 'Teilweise metabolische Kompensation durch renale Bikarbonat-Retention. Dies deutet auf eine bereits l√§nger bestehende Hypoventilation hin.',
          nursing: 'Regelm√§√üige Vitalkapazit√§tsmessungen, Beratung zu NIV-Therapie, Sekretmanagement, Hustenassistenz-Techniken. Fr√ºhzeitige Einbindung palliativmedizinischer Versorgung.'
        }
      },
      {
        id: 13, mode: 'basic', complexity: 'Basis',
        context: 'Verkehrsunfall mit Rippenserienfraktur rechts, starke atemabh√§ngige Schmerzen.',
        ph: 7.30, pco2: 56, hco3: 26, be: 0, laktat: 1.8, na: 138, cl: 104, k: 4.3, glukose: 130,
        primary: 'RESP_ACI', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Rippenfrakturen f√ºhren zu starken atemabh√§ngigen Schmerzen und damit zur Schonatmung. Zus√§tzlich kann eine Lungenkontusion die Gasaustauschfl√§che reduzieren.',
          compensation: 'Akute St√∂rung ohne Kompensation. Das leicht erh√∂hte Laktat kann auf eine beginnende Gewebehypoxie oder Stressreaktion hinweisen.',
          nursing: 'Ad√§quate Schmerztherapie (Epiduralkatheter erw√§gen), Atemtherapie mit Anleitung zu effektiver Hustentechnik, Mobilisation unter Schmerzschutz, Pneumonie-Prophylaxe.'
        }
      },
      {
        id: 14, mode: 'basic', complexity: 'Basis',
        context: 'Beatmeter Patient auf Intensivstation, Alarm hoher pCO‚ÇÇ. Tidalvolumen zu niedrig.',
        ph: 7.27, pco2: 65, hco3: 27, be: 1, laktat: 1.1, na: 141, cl: 105, k: 4.0, glukose: 105,
        primary: 'RESP_ACI', comp_basic: 'PARTIAL', comp_advanced: 'MET_PARTIAL',
        explanation: {
          pathophysiology: 'Bei unzureichenden Beatmungsparametern wird nicht genug CO‚ÇÇ abgeatmet. Dies f√ºhrt zur iatrogenen respiratorischen Azidose.',
          compensation: 'Beginnende metabolische Kompensation. Bei beatmeten Patienten sollte jedoch prim√§r die Beatmung optimiert werden.',
          nursing: 'Beatmungsparameter mit Arzt besprechen und anpassen. Ursachen f√ºr erh√∂hten Atemwegswiderstand ausschlie√üen: Tubuslage, Sekret, Bronchospasmus pr√ºfen.'
        }
      },
      {
        id: 15, mode: 'basic', complexity: 'Basis',
        context: 'Beatmeter Patient nach Sch√§del-Hirn-Trauma, Atemfrequenz erh√∂ht wegen ICP.',
        ph: 7.50, pco2: 30, hco3: 23, be: -1, laktat: 1.0, na: 140, cl: 103, k: 4.0, glukose: 105,
        primary: 'RESP_ALK', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Bei erh√∂htem intrakraniellem Druck wird manchmal therapeutisch eine leichte Hyperventilation eingesetzt. Der niedrige pCO‚ÇÇ f√ºhrt zu zerebraler Vasokonstriktion.',
          compensation: 'Keine Kompensation bei akuter, therapeutisch gewollter Hyperventilation.',
          nursing: 'Bei SHT-Patienten ist dies teils gewollt, aber engmaschiges ICP-Monitoring erforderlich. Ziel-pCO‚ÇÇ meist 32 bis 35 mmHg, niemals unter 30 mmHg. Zu starke Hyperventilation kann Hirndurchblutung gef√§hrden.'
        }
      },
      {
        id: 16, mode: 'basic', complexity: 'Basis',
        context: 'Bergsteiger in 3500 Meter H√∂he, Kopfschmerzen, √úbelkeit, Schwindel, schnelle Atmung.',
        ph: 7.46, pco2: 33, hco3: 23, be: -1, laktat: 1.2, na: 138, cl: 104, k: 4.1, glukose: 95,
        primary: 'RESP_ALK', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'In gro√üer H√∂he ist der Sauerstoffpartialdruck niedriger. Der K√∂rper reagiert mit kompensatorischer Hyperventilation, dabei wird auch mehr CO‚ÇÇ abgeatmet.',
          compensation: 'Noch keine Kompensation, da die H√∂henexposition erst seit kurzem besteht. Bei l√§ngerer Akklimatisation w√ºrden die Nieren durch Bikarbonat-Ausscheidung kompensieren.',
          nursing: 'Bei H√∂henkrankheit ist Abstieg die beste Therapie. Symptomatische Behandlung mit Analgetika gegen Kopfschmerzen. Bei Verschlechterung: sofortiger Abstieg lebensnotwendig. Prophylaxe durch langsame Akklimatisation.'
        }
      },
      {
        id: 17, mode: 'basic', complexity: 'Basis',
        context: 'Patientin mit Harnwegsinfekt, seit heute Fieber 39 Grad, Tachypnoe 28 pro Minute, verwirrt.',
        ph: 7.48, pco2: 31, hco3: 23, be: -1, laktat: 2.4, na: 137, cl: 105, k: 4.3, glukose: 145,
        primary: 'RESP_ALK', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Bei beginnender Sepsis f√ºhren Entz√ºndungsmediatoren zu einer Stimulation des Atemzentrums. Dies ist eines der fr√ºhen Zeichen einer Sepsis. Das erh√∂hte Laktat ist wichtiger Hinweis auf systemische Entz√ºndung.',
          compensation: 'Akute St√∂rung ohne Kompensation. Wichtig: Das erh√∂hte Laktat deutet darauf hin, dass sich m√∂glicherweise bald auch eine metabolische Azidose entwickeln wird.',
          nursing: 'SEPSIS-Verdacht gleich NOTFALL! Blutkulturen abnehmen, dann sofort Breitspektrum-Antibiotika innerhalb einer Stunde, Fl√ºssigkeitstherapie nach Protokoll. Engmaschiges Monitoring, qSOFA-Score dokumentieren.'
        }
      },
      {
        id: 18, mode: 'basic', complexity: 'Basis',
        context: 'Patient nach Verkehrsunfall, pl√∂tzliche Dyspnoe und Thoraxschmerz, frisch operiert vor f√ºnf Tagen.',
        ph: 7.50, pco2: 29, hco3: 22, be: -2, laktat: 1.8, na: 139, cl: 106, k: 4.0, glukose: 115,
        primary: 'RESP_ALK', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Bei Lungenembolie f√ºhren die pl√∂tzliche Dyspnoe und Hypoxie zu reflektorischer Hyperventilation. Zus√§tzlich werden Irritationsrezeptoren in der Lunge stimuliert. Das leicht erh√∂hte Laktat kann auf rechtsventrikul√§re Belastung hinweisen.',
          compensation: 'Keine Kompensation bei akutem Ereignis. Die respiratorische Alkalose ist hier ein wichtiger diagnostischer Hinweis bei Verdacht auf Lungenembolie.',
          nursing: 'Lungenembolie gleich NOTFALL! Sofortige √§rztliche Untersuchung, D-Dimer-Bestimmung, CT-Angiographie. Sauerstoff-Gabe, Oberk√∂rperhochlagerung, Antikoagulation nach Anordnung. Thrombose-Prophylaxe-Standards √ºberpr√ºfen.'
        }
      },
      {
        id: 19, mode: 'basic', complexity: 'Basis',
        context: 'Dialyse-Patient, letzte Dialyse vor vier Tagen, heute terminliche Dialyse ausgefallen.',
        ph: 7.32, pco2: 32, hco3: 16, be: -9, laktat: 1.3, na: 140, cl: 106, k: 5.5, glukose: 108,
        primary: 'MET_ACI', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Bei chronischer Niereninsuffizienz akkumulieren Stoffwechsels√§uren kontinuierlich. Die Dialyse entfernt diese S√§uren regelm√§√üig. Wenn die Dialyse ausf√§llt, verschlechtert sich die Azidose. Die Hyperkali√§mie ist typisch und potenziell lebensbedrohlich.',
          compensation: 'Teilweise respiratorische Kompensation durch Hyperventilation. Bei chronischen Dialysepatienten ist eine leichte metabolische Azidose oft chronisch vorhanden.',
          nursing: 'DRINGEND Dialyse organisieren! EKG-Kontrolle wegen Hyperkali√§mie. Fl√ºssigkeits- und Kalium-Restriktion bis zur Dialyse. Bei Kalium √ºber sechs oder EKG-Ver√§nderungen: Notfall-Ma√ünahmen wie Calcium intraven√∂s, Insulin plus Glukose.'
        }
      },
      {
        id: 20, mode: 'basic', complexity: 'Basis',
        context: 'Diabetikerin unter Metformin, seit zwei Tagen Durchfall und Erbrechen, zunehmend verwirrt.',
        ph: 7.20, pco2: 30, hco3: 11, be: -14, laktat: 8.2, na: 137, cl: 105, k: 4.9, glukose: 95,
        primary: 'MET_ACI', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Metformin hemmt die Glukoneogenese in der Leber. Bei eingeschr√§nkter Nierenfunktion durch Exsikkose f√ºhrt dies zur Laktat-Akkumulation. Laktat kann nicht mehr zu Glukose umgewandelt werden. Das extrem hohe Laktat und der niedrige Blutzucker sind typisch.',
          compensation: 'Teilweise respiratorische Kompensation, aber bei so schwerem Laktat-Anstieg insuffizient. Die Verwirrtheit ist Zeichen der schweren Azidose und Gewebehypoxie.',
          nursing: 'NOTFALL - Intensivstation! Metformin SOFORT absetzen. Volumengabe, Bikarbonat-Pufferung bei pH unter 7.1, bei refrakt√§ren F√§llen: Dialyse zur Laktat- und Metformin-Elimination. Glukose-Infusion wegen Hypoglyk√§mie-Gefahr.'
        }
      },
      {
        id: 21, mode: 'basic', complexity: 'Basis',
        context: 'Junger Mann nach exzessivem Crossfit-Training, extreme Muskelschmerzen, Cola-farbener Urin.',
        ph: 7.26, pco2: 33, hco3: 14, be: -11, laktat: 3.2, na: 139, cl: 106, k: 5.6, glukose: 110,
        primary: 'MET_ACI', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Bei Rhabdomyolyse werden durch Muskelzellzerfall massiv intrazellul√§re Substanzen freigesetzt: Myoglobin, Kalium, Phosphat, Purine. Die Hyperurik√§mie und Phosphat-Freisetzung f√ºhren zur metabolischen Azidose. Myoglobin ist nephrotoxisch und kann zu akutem Nierenversagen f√ºhren.',
          compensation: 'Teilweise respiratorische Kompensation durch Hyperventilation. Die Kreatinkinase w√§re hier extrem erh√∂ht √ºber zehntausend U pro Liter, diagnostisch wichtig.',
          nursing: 'Aggressive Volumengabe von sechs bis zw√∂lf Liter pro Tag zur Ausschwemmung von Myoglobin und Nierenschutz. Urin-Alkalisierung mit Natriumbikarbonat erw√§gen, pH √ºber 6.5 anstreben. St√ºndliche Urinkontrollen. Hyperkali√§mie-Monitoring am EKG. Bei Oligurie trotz Volumengabe: Nierenersatzverfahren.'
        }
      },
      {
        id: 22, mode: 'basic', complexity: 'Basis',
        context: 'Patient nach Ingestion von Frostschutzmittel vor sechs Stunden, zunehmend somnolent, Sehst√∂rungen.',
        ph: 7.15, pco2: 26, hco3: 9, be: -16, laktat: 4.5, na: 138, cl: 98, k: 4.2, glukose: 105,
        primary: 'MET_ACI', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Ethylenglykol wird in der Leber zu toxischen Metaboliten abgebaut: Glykols√§ure, Oxals√§ure. Diese verursachen eine schwere metabolische Azidose mit erh√∂hter Anionenl√ºcke. Die Oxalat-Kristalle sch√§digen die Nieren. Die Sehst√∂rungen entstehen durch Sch√§digung des Nervus opticus.',
          compensation: 'Teilweise respiratorische Kompensation, aber insuffizient bei so schwerer Vergiftung. Die osmotische L√ºcke ist hier erh√∂ht, wichtiges diagnostisches Kriterium neben der Anionenl√ºcke.',
          nursing: 'VERGIFTUNGS-NOTFALL! Giftnotruf einschalten. Antidot: Fomepizol hemmt Alkoholdehydrogenase, verhindert toxische Metaboliten, oder alternativ Ethanol-Infusion. H√§modialyse bei schwerer Vergiftung. Volumengabe, Bikarbonat-Pufferung. Thiamin und Pyridoxin geben. Regelm√§√üige Osmolalit√§t-Kontrollen.'
        }
      },
      {
        id: 23, mode: 'basic', complexity: 'Basis',
        context: 'Patient drei Wochen nach Darm-OP mit Ileostoma, Ausscheidung √ºber zwei Liter pro Tag, schwach und schwindelig.',
        ph: 7.31, pco2: 36, hco3: 18, be: -7, laktat: 1.1, na: 134, cl: 110, k: 3.1, glukose: 92,
        primary: 'MET_ACI', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Bei Ileostoma mit hohem Output gehen gro√üe Mengen bikarbonatreicher Fl√ºssigkeit verloren. Der Dickdarm, der normalerweise Wasser und Bikarbonat r√ºckresorbiert, fehlt. Dies f√ºhrt zur hyperchlor√§mischen metabolischen Azidose. Die Hypokali√§mie und Hyponatri√§mie entstehen durch die Elektrolytverluste.',
          compensation: 'Keine respiratorische Kompensation erkennbar. Die St√∂rung entwickelt sich subakut √ºber Tage bis Wochen.',
          nursing: 'Stomaberatung einschalten! Motilit√§tshemmer erw√§gen wie Loperamid. Volumengabe mit balancierten Elektrolytl√∂sungen. Orale Rehydratationsl√∂sung, spezielle Stoma-L√∂sungen. Kalium und Magnesium substituieren. Patienten-Schulung: ausreichend Trinken von zwei bis drei Liter pro Tag, Meiden von stark abf√ºhrenden Nahrungsmitteln.'
        }
      },
      {
        id: 24, mode: 'basic', complexity: 'Basis',
        context: 'Patient mit Pneumonie-Sepsis, Fieber 39.5 Grad, Tachykardie, Hypotonie trotz Volumengabe.',
        ph: 7.25, pco2: 30, hco3: 13, be: -12, laktat: 5.2, na: 136, cl: 105, k: 4.6, glukose: 175,
        primary: 'MET_ACI', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Bei Sepsis f√ºhren Entz√ºndungsmediatoren zu Mikrozirkulationsst√∂rungen und Gewebehypoxie. Trotz ausreichender Sauerstoff-S√§ttigung k√∂nnen die Zellen den Sauerstoff nicht verwerten, sogenannte zytopathische Hypoxie. Dies f√ºhrt zu anaerober Glykolyse und Laktat-Akkumulation. Das Laktat ist hier Marker f√ºr Organdysfunktion und Mortalit√§t. Laktat √ºber vier mmol pro Liter definiert den septischen Schock.',
          compensation: 'Teilweise respiratorische Kompensation durch septische Hyperventilation. Der niedrige pCO‚ÇÇ zeigt die Atemantwort auf die Azidose und ist gleichzeitig Zeichen der Sepsis selbst.',
          nursing: 'SEPSIS gleich NOTFALL! Sepsis-Bundle innerhalb einer Stunde: Blutkulturen, Antibiotika, Volumengabe drei√üig ml pro kg, Laktat-Kontrolle. Katecholamine bei persistierender Hypotonie, Noradrenalin ist first-line. Focus-Sanierung hier: Pneumonie-Therapie. Engmaschiges Monitoring, Organfunktionen √ºberwachen. Laktat-Clearance ist wichtiger Verlaufsparameter.'
        }
      },
      {
        id: 25, mode: 'advanced', complexity: 'Advanced',
        context: 'Patient mit ausgedehnter Darmresektion, chronische Diarrhoe, neurologische Symptome wie Ataxie, undeutliche Sprache.',
        ph: 7.28, pco2: 31, hco3: 14, be: -11, laktat: 1.8, na: 137, cl: 106, k: 3.8, glukose: 95,
        primary: 'MET_ACI', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Bei Kurzdarmsyndrom entsteht durch bakterielle Fehlbesiedlung D-Laktat im Gegensatz zum normalen L-Laktat. Standard-Laktat-Tests messen nur L-Laktat, daher ist das gemessene Laktat hier normal niedrig trotz schwerer Azidose. D-Laktat ist neurotoxisch und verursacht die charakteristischen neurologischen Symptome. Die erh√∂hte Anionenl√ºcke trotz normalem Laktat ist der diagnostische Hinweis.',
          compensation: 'Teilweise respiratorische Kompensation. Diese seltene Form der Azidose wird oft fehldiagnostiziert, weil das Standard-Laktat nicht erh√∂ht ist. Man muss gezielt D-Laktat bestimmen.',
          nursing: 'Spezialfall! D-Laktat muss speziell angefordert werden, nicht im Standard-Labor. Therapie: Antibiotika gegen bakterielle Fehlbesiedlung, Probiotika, Ern√§hrungsumstellung kohlenhydratarm. Neurologische Symptome bilden sich nach Behandlung meist zur√ºck. Patienten mit Kurzdarmsyndrom ben√∂tigen spezialisierte Ern√§hrungsberatung. Cave: diese Patienten sind oft unterern√§hrt und ben√∂tigen gegebenenfalls parenterale Ern√§hrung.'
        }
      },
      {
        id: 26, mode: 'advanced', complexity: 'Advanced',
        context: 'Diabetiker mit Herzinsuffizienz, nimmt Metformin, jetzt kardiogene Dekompensation mit √ñdemen.',
        ph: 7.19, pco2: 28, hco3: 10, be: -15, laktat: 9.5, na: 132, cl: 98, k: 5.4, glukose: 78,
        primary: 'MET_ACI', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Bei kardialer Dekompensation kommt es zur Gewebehypoperfusion. In Kombination mit Metformin, das die mitochondriale Atmung hemmt, entsteht die Metformin-assoziierte Laktatazidose MALA. Die eingeschr√§nkte Nierenfunktion bei Herzinsuffizienz f√ºhrt zu Metformin-Akkumulation. Das extrem hohe Laktat von 9.5 und die Hypoglyk√§mie trotz Diabetes sind charakteristisch. Die Hyponatri√§mie ist typisch f√ºr dekompensierte Herzinsuffizienz.',
          compensation: 'Respiratorische Teilkompensation, aber bei so extremer Azidose insuffizient. MALA hat eine hohe Mortalit√§t von drei√üig bis f√ºnfzig Prozent.',
          nursing: 'H√ñCHSTE NOTFALLSTUFE! Intensivstation, Metformin sofort stoppen. Herzinsuffizienz-Therapie optimieren mit Diuretika, Katecholamine bei Bedarf. Bikarbonat-Pufferung bei pH unter 7.1. H√§modialyse erw√§gen, entfernt Metformin und Laktat. Glukose-Infusion wegen Hypoglyk√§mie-Risiko. Cave: Metformin ist bei schwerer Herzinsuffizienz NYHA drei bis vier kontraindiziert, h√§tte nie gegeben werden d√ºrfen.'
        }
      },
      {
        id: 27, mode: 'advanced', complexity: 'Advanced',
        context: 'Beatmeter Patient, seit f√ºnf Tagen Propofol-Dauersedierung, jetzt Bradykardie, gr√ºnlicher Urin, Herzrhythmusst√∂rungen.',
        ph: 7.20, pco2: 35, hco3: 13, be: -12, laktat: 7.8, na: 138, cl: 105, k: 5.9, glukose: 45,
        primary: 'MET_ACI', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Das Propofol-Infusions-Syndrom ist eine seltene, aber lebensbedrohliche Komplikation bei Langzeit-Propofol-Gabe √ºber achtundvierzig Stunden, √ºber vier mg pro kg pro Stunde. Es kommt zu mitochondrialer Dysfunktion mit Laktatazidose, Rhabdomyolyse daher der gr√ºne Urin durch Myoglobin, Herzversagen und Hyperkali√§mie. Die Hypoglyk√§mie entsteht durch gest√∂rte Glukoneogenese. Triglyzeride sind massiv erh√∂ht √ºber tausend mg pro dl.',
          compensation: 'Keine Kompensation bei akutem Organversagen. Die Bradykardie und Arrhythmien sind Zeichen der kardialen Beteiligung. PRIS hat eine Mortalit√§t von drei√üig bis achtzig Prozent.',
          nursing: 'LEBENSBEDROHLICHER NOTFALL! Propofol SOFORT stoppen, auf alternatives Sedativum umstellen wie Midazolam. Intensivtherapie: Volumengabe, Pufferung, bei Herzversagen: Katecholamine, gegebenenfalls ECMO erw√§gen. Dialyse bei refrakt√§rer Azidose. Triglyzeride, CK, Myoglobin kontrollieren. Cave: bei Kindern und auf Intensivstation besonders aufmerksam sein, PRIS vermeiden durch Dosislimitierung und zeitliche Begrenzung von Propofol.'
        }
      },
      {
        id: 28, mode: 'advanced', complexity: 'Advanced',
        context: 'Leuk√§mie-Patient, zweiter Tag nach Chemotherapie-Beginn, Oligurie, Herzrhythmusst√∂rungen.',
        ph: 7.24, pco2: 30, hco3: 12, be: -13, laktat: 2.1, na: 136, cl: 104, k: 6.8, glukose: 105,
        primary: 'MET_ACI', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Beim Tumor-Lyse-Syndrom werden durch den massiven Zerfall von Tumorzellen gro√üe Mengen intrazellul√§rer Substanzen freigesetzt: Kalium, Phosphat, Purine. Die Purine werden zu Harns√§ure abgebaut, die ausf√§llt und die Nieren sch√§digt, akutes Nierenversagen. Die Hyperphosphat√§mie bindet Calcium, Hypokalz√§mie mit Tetanie-Risiko. Die metabolische Azidose entsteht durch Nierenversagen und Phosphat-Akkumulation. Die Hyperkali√§mie ist extrem gef√§hrlich, Herzstillstand-Risiko.',
          compensation: 'Teilweise respiratorische Kompensation, aber bei so schwerer St√∂rung insuffizient. Dies ist ein onkologischer Notfall.',
          nursing: 'ONKOLOGISCHER NOTFALL! Intensivmonitoring mit Tele-EKG wegen Hyperkali√§mie. Aggressive Hyperhydratation drei Liter pro m¬≤ pro Tag, Urin-Alkalisierung. Rasburicase spaltet Harns√§ure. Bei Hyperkali√§mie √ºber 6.5: Notfall-Management mit Calcium intraven√∂s, Insulin plus Glukose. Dialyse bei refrakt√§rem Nierenversagen. Phosphatbinder, Calcium-Substitution bei Hypokalz√§mie. Engmaschige Laborkontrollen alle vier bis sechs Stunden.'
        }
      },
      {
        id: 29, mode: 'advanced', complexity: 'Advanced',
        context: 'Patientin mit unbehandelter Hyperthyreose, jetzt Fieber vierzig Grad, Tachykardie hundertsechzig pro Minute, massiv geschwitzt.',
        ph: 7.51, pco2: 27, hco3: 21, be: -3, laktat: 3.2, na: 148, cl: 110, k: 3.0, glukose: 165,
        primary: 'RESP_ALK', comp_basic: 'NONE', comp_advanced: 'MET_PARTIAL',
        explanation: {
          pathophysiology: 'Die thyreotoxische Krise ist ein lebensbedrohlicher Notfall. Der massive √úberschuss an Schilddr√ºsenhormonen f√ºhrt zu extremer Stoffwechselsteigerung mit Hyperventilation. Die Hypernatri√§mie von einhundertachtundvierzig und Hypokali√§mie von drei entstehen durch Schwitzen und gesteigerte Diurese. Das erh√∂hte Laktat zeigt die metabolische Entgleisung.',
          compensation: 'Beginnende metabolische Kompensation durch renale Bikarbonat-Ausscheidung, HCO‚ÇÉ‚Åª und BE leicht erniedrigt. Aber: Die Situation ist zu akut f√ºr vollst√§ndige Kompensation. Das Laktat deutet zus√§tzlich auf eine beginnende metabolische Azidose hin.',
          nursing: 'NOTFALL - Intensivstation! Thyreostatika hochdosiert, Betablocker Cave: keine Kontraindikationen, Cortison, Fl√ºssigkeit und Elektrolyte. K√ºhlung keine Eisb√§der. Monitoring von Temperatur, Herzfrequenz, Blutdruck. Die Hypokali√§mie muss dringend korrigiert werden, Arrhythmie-Gefahr bei Tachykardie. Mortalit√§t ohne Behandlung bis drei√üig Prozent.'
        }
      },
      {
        id: 30, mode: 'advanced', complexity: 'Advanced',
        context: 'Schwangere in sechsunddrei√üigster SSW, leichte Luftnot beim Treppensteigen, ansonsten beschwerdefrei.',
        ph: 7.44, pco2: 32, hco3: 21, be: -3, laktat: 1.0, na: 136, cl: 104, k: 3.8, glukose: 88,
        primary: 'RESP_ALK', comp_basic: 'PARTIAL', comp_advanced: 'MET_PARTIAL',
        explanation: {
          pathophysiology: 'In der Schwangerschaft f√ºhrt das Hormon Progesteron zu einer gesteigerten Atemantwort. Zus√§tzlich dr√ºckt der wachsende Uterus das Zwerchfell nach oben, was die funktionelle Residualkapazit√§t reduziert. Der K√∂rper kompensiert mit erh√∂hter Atemfrequenz. Dies ist eine physiologische Anpassung an die Schwangerschaft.',
          compensation: 'Teilweise metabolische Kompensation durch die Nieren. Dies zeigt, dass die Hyperventilation schon l√§nger besteht. Diese BGA-Ver√§nderungen sind f√ºr das dritte Trimenon normal und stellen keine Krankheit dar.',
          nursing: 'Schwangere √ºber die physiologischen Ver√§nderungen aufkl√§ren, dies ist normal. Atem√ºbungen k√∂nnen helfen, mit der Dyspnoe besser umzugehen. Eisenstatus pr√ºfen, An√§mie kann Dyspnoe verst√§rken. Bei starker Verschlechterung oder zus√§tzlichen Symptomen wie Brustschmerz, starke √ñdeme: an Pr√§eklampsie oder Lungenembolie denken.'
        }
      },
      {
        id: 31, mode: 'basic', complexity: 'Basis',
        context: 'Patientin mit unstillbarem Erbrechen seit drei Tagen, Gastroenteritis, kann nichts bei sich behalten.',
        ph: 7.52, pco2: 45, hco3: 36, be: 10, laktat: 1.0, na: 138, cl: 92, k: 2.8, glukose: 95,
        primary: 'MET_ALK', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Bei anhaltendem Erbrechen geht Magens√§ure verloren, die reich an Salzs√§ure ist. Der K√∂rper verliert also Wasserstoff-Ionen und Chlorid. Dies f√ºhrt zur metabolischen Alkalose. Die Hypokali√§mie entsteht durch renale Verluste, da die Niere bei Alkalose vermehrt Kalium ausscheidet. Die Hypochlor√§mie ist charakteristisch f√ºr diese Form der Alkalose.',
          compensation: 'Teilweise respiratorische Kompensation durch Hypoventilation. Der K√∂rper versucht, durch verminderte Atmung CO‚ÇÇ zur√ºckzuhalten und so den pH zu senken. Der pCO‚ÇÇ ist leicht erh√∂ht.',
          nursing: 'Volumengabe mit NaCl 0.9 Prozent zur Korrektur der Chlorid-Depletion. Kalium-Substitution ist essentiell, aber Vorsicht: nur bei ausreichender Diurese geben. Antiemetika zur Unterbrechung des Erbrechens. Cave: Die Hypokali√§mie kann zu Herzrhythmusst√∂rungen f√ºhren, EKG-Kontrolle empfohlen.'
        }
      },
      {
        id: 32, mode: 'basic', complexity: 'Basis',
        context: 'Patient auf Intensivstation, Magensonde l√§uft seit f√ºnf Tagen auf Sog, gro√üe Mengen Magensekret.',
        ph: 7.50, pco2: 44, hco3: 34, be: 8, laktat: 0.9, na: 140, cl: 94, k: 3.0, glukose: 105,
        primary: 'MET_ALK', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Wenn eine Magensonde kontinuierlich Magensekret absaugt, geht wie beim Erbrechen Salzs√§ure verloren. Pro Liter Magensaft gehen etwa 100 mmol Chlorid und entsprechend Wasserstoff-Ionen verloren. Dies ist eine iatrogene metabolische Alkalose.',
          compensation: 'Teilweise respiratorische Kompensation durch leichte Hypoventilation. Bei beatmeten Patienten kann diese Kompensation durch die Beatmungseinstellung begrenzt sein.',
          nursing: 'Magensonden-Management √ºberpr√ºfen: Ist die kontinuierliche Absaugung wirklich notwendig oder kann auf intermittierende Absaugung umgestellt werden? Chlorid- und Kalium-Substitution. Protonenpumpeninhibitoren reduzieren die Magens√§ureproduktion. Bei schwerer Alkalose: H2-Blocker oder PPI erw√§gen.'
        }
      },
      {
        id: 33, mode: 'basic', complexity: 'Basis',
        context: 'Herzinsuffizienz-Patientin unter Furosemid-Hochdosis-Therapie, heute sehr schwach, Muskelkr√§mpfe.',
        ph: 7.48, pco2: 43, hco3: 32, be: 6, laktat: 1.1, na: 136, cl: 96, k: 2.6, glukose: 110,
        primary: 'MET_ALK', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Schleifendiuretika wie Furosemid f√ºhren zu einem massiven Verlust von Chlorid und Kalium √ºber die Niere. Der Chlorid-Verlust ist der prim√§re Mechanismus der metabolischen Alkalose. Zus√§tzlich aktiviert die Volumenkontraktion das Renin-Angiotensin-Aldosteron-System, was die Alkalose weiter verst√§rkt. Die Hypokali√§mie ist bei Diuretika-Therapie besonders gef√§hrlich.',
          compensation: 'Teilweise respiratorische Kompensation. Die Muskelkr√§mpfe entstehen durch die Hypokali√§mie und die alkalosebedingte Verschiebung von ionisiertem Calcium.',
          nursing: 'Diuretika-Dosis mit Arzt besprechen, eventuell reduzieren oder Kalium-sparende Diuretika erg√§nzen wie Spironolacton. Aggressive Kalium-Substitution, Ziel-Kalium √ºber 4.0 mmol pro Liter. Magnesium kontrollieren und substituieren, Magnesiummangel verhindert Kalium-Aufnahme in die Zellen. EKG-Monitoring wegen Arrhythmie-Risiko bei Hypokali√§mie.'
        }
      },
      {
        id: 34, mode: 'basic', complexity: 'Basis',
        context: 'Patient mit Hyperaldosteronismus, Hypertonie therapierefrakt√§r, Muskelschw√§che, h√§ufiges Wasserlassen.',
        ph: 7.46, pco2: 42, hco3: 30, be: 5, laktat: 0.8, na: 144, cl: 98, k: 2.4, glukose: 100,
        primary: 'MET_ALK', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Bei Hyperaldosteronismus produziert die Nebenniere √ºberm√§√üig Aldosteron. Dies f√ºhrt zu vermehrter Natrium-R√ºckresorption und Kalium-Ausscheidung in der Niere. Parallel werden Wasserstoff-Ionen ausgeschieden, was zur metabolischen Alkalose f√ºhrt. Die schwere Hypokali√§mie unter 2.5 ist typisch und kann zu L√§hmungen f√ºhren.',
          compensation: 'Teilweise respiratorische Kompensation. Die Muskelschw√§che entsteht durch die ausgepr√§gte Hypokali√§mie.',
          nursing: 'Aldosteron-Antagonist wie Spironolacton ist die kausale Therapie. Gro√üz√ºgige Kalium-Substitution, oft sind sehr hohe Dosen n√∂tig. Blutdruck-Monitoring. Bei schwerer Hypokali√§mie unter 2.5: kontinuierliche Kalium-Infusion √ºber Perfusor erw√§gen, nie als Bolus geben. EKG-Monitoring obligat. Nach Diagnosestellung eventuell operative Therapie bei Nebennieren-Adenom.'
        }
      },
      {
        id: 35, mode: 'basic', complexity: 'Basis',
        context: 'Patient nach massiver Bluttransfusion, zehn Erythrozytenkonzentrate in drei Stunden, jetzt Kribbeln in H√§nden.',
        ph: 7.46, pco2: 41, hco3: 29, be: 4, laktat: 1.2, na: 139, cl: 100, k: 3.8, glukose: 105,
        primary: 'MET_ALK', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Erythrozytenkonzentrate enthalten Citrat als Antikoagulans. Bei massiver Transfusion wird viel Citrat infundiert, das in der Leber zu Bikarbonat verstoffwechselt wird. Dies f√ºhrt zur metabolischen Alkalose. Das Kribbeln entsteht, weil Citrat Calcium bindet und eine Hypokalz√§mie verursacht, verst√§rkt durch die Alkalose.',
          compensation: 'Keine Kompensation erkennbar bei akutem Ereignis. Diese Form der Alkalose ist selbstlimitierend und bessert sich nach Beendigung der Transfusion.',
          nursing: 'Calcium-Substitution bei symptomatischer Hypokalz√§mie, Calcium-Gluconat langsam intraven√∂s. Bei Massivtransfusion: prophylaktische Calcium-Gabe erw√§gen. Gerinnungsmonitoring, da Citrat auch die Gerinnung beeinflusst. Diese Form der Alkalose ist meist mild und bedarf keiner spezifischen Therapie au√üer Calcium-Substitution.'
        }
      },
      {
        id: 36, mode: 'advanced', complexity: 'Advanced',
        context: 'Intensivpatient, mechanisch beatmet, wurde f√ºr Bronchoskopie stark hyperventiliert, danach Bikarbonat-Gabe.',
        ph: 7.58, pco2: 38, hco3: 35, be: 10, laktat: 1.0, na: 142, cl: 96, k: 3.4, glukose: 115,
        primary: 'MET_ALK', comp_basic: 'NONE', comp_advanced: 'C_MIXED',
        explanation: {
          pathophysiology: 'Dies ist eine iatrogene gemischte Alkalose. Bei der Bronchoskopie wurde der Patient hyperventiliert, was zu respiratorischer Alkalose f√ºhrte. Wenn dann zus√§tzlich Bikarbonat gegeben wurde, entsteht eine additive St√∂rung. Beide Komponenten treiben den pH nach oben. Der pCO‚ÇÇ hat sich nach der Bronchoskopie normalisiert, aber das Bikarbonat ist massiv erh√∂ht. Dies ist eine der schwersten Formen der Alkalose.',
          compensation: 'Keine Kompensation m√∂glich, da beide Systeme in die gleiche Richtung verschoben sind. Eine gemischte Alkalose ist selten, aber kann bei iatrogenen Ursachen auftreten. Der pH √ºber 7.55 ist gef√§hrlich.',
          nursing: 'Beatmung anpassen, keine weitere Hyperventilation. Keine weiteren Bikarbonat-Gaben. Chlorid-reiche Infusionen geben wie NaCl 0.9 Prozent. Bei pH √ºber 7.6: Acetazolamid erw√§gen, hemmt renale Bikarbonat-R√ºckresorption. Kalium √ºberwachen und substituieren. Monitoring auf Krampfanf√§lle bei schwerer Alkalose, da diese die zerebrale Durchblutung reduziert.'
        }
      },
      {
        id: 37, mode: 'advanced', complexity: 'Advanced',
        context: 'Patient mit Cushing-Syndrom, stammbetonte Adipositas, Vollmondgesicht, seit Wochen Muskelschw√§che.',
        ph: 7.47, pco2: 42, hco3: 30, be: 5, laktat: 0.9, na: 146, cl: 98, k: 2.5, glukose: 185,
        primary: 'MET_ALK', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Beim Cushing-Syndrom ist zu viel Cortisol im K√∂rper. Cortisol hat eine schwache mineralocorticoide Wirkung, √§hnlich wie Aldosteron. Dies f√ºhrt zu Natrium-Retention, Kalium-Ausscheidung und Wasserstoff-Ionen-Verlust √ºber die Niere. Die Hyperglyk√§mie entsteht durch die diabetogene Wirkung von Cortisol. Die Hypernatri√§mie ist typisch.',
          compensation: 'Teilweise respiratorische Kompensation. Die Muskelschw√§che ist multifaktoriell: Hypokali√§mie, Myopathie durch Cortisol-√úberschuss, und die katabole Wirkung von Cortisol auf die Muskulatur.',
          nursing: 'Behandlung der Grunderkrankung durch Endokrinologie. Kalium-Substitution. Blutdruck-Monitoring, da Hypertonie typisch ist. Blutzucker-Kontrollen, oft entwickelt sich ein Steroid-Diabetes. Hautpflege besonders wichtig, da Cortisol die Haut ausd√ºnnt und Wundheilung verschlechtert. Thromboseprophylaxe, Cushing erh√∂ht Thrombose-Risiko.'
        }
      },
      {
        id: 38, mode: 'advanced', complexity: 'Advanced',
        context: 'Neugeborenes, zweiter Lebenstag, erbricht gallig, gebl√§htes Abdomen, Verdacht auf Pylorusstenose.',
        ph: 7.54, pco2: 44, hco3: 37, be: 11, laktat: 1.5, na: 136, cl: 88, k: 3.2, glukose: 75,
        primary: 'MET_ALK', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Die hypertrophe Pylorusstenose ist eine Verengung des Magenausgangs beim S√§ugling. Das Kind erbricht nach jeder Mahlzeit im Schwall, verliert dabei Magens√§ure. Dies f√ºhrt zur klassischen hypochlor√§mischen hypokal√§mischen metabolischen Alkalose. Die Hypochlor√§mie ist besonders ausgepr√§gt. Das galliges Erbrechen deutet auf eine Obstruktion hin.',
          compensation: 'Teilweise respiratorische Kompensation. Bei S√§uglingen ist die Kompensationsf√§higkeit noch eingeschr√§nkt.',
          nursing: 'KINDERCHIRURGISCHER NOTFALL! Magensonde legen, aber nicht absaugen. Volumengabe mit NaCl 0.9 Prozent und Kalium nach Kontrolle. Pr√§operative Stabilisierung obligat, nie mit schwerer Alkalose operieren. Glukose-haltige Infusionen wegen Hypoglyk√§mie-Risiko. Eltern-Aufkl√§rung und Begleitung. Nach Korrektur der Elektrolyte: Pyloromyotomie. Prognose nach OP exzellent.'
        }
      },
      {
        id: 39, mode: 'advanced', complexity: 'Advanced',
        context: 'Bulimie-Patientin, gibt zu, mehrfach t√§glich zu erbrechen und Laxantien zu missbrauchen.',
        ph: 7.50, pco2: 43, hco3: 33, be: 8, laktat: 1.0, na: 138, cl: 92, k: 2.6, glukose: 85,
        primary: 'MET_ALK', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Bei Bulimie mit selbstinduziertem Erbrechen entsteht die gleiche metabolische Alkalose wie bei anderen Formen des Erbrechens. Der chronische Verlust von Magens√§ure und Chlorid f√ºhrt zur anhaltenden Alkalose. Die Hypokali√§mie ist besonders gef√§hrlich und kann zu lebensbedrohlichen Herzrhythmusst√∂rungen f√ºhren. Zus√§tzlicher Laxantien-Missbrauch kann paradoxerweise auch zu Elektrolytverlusten f√ºhren.',
          compensation: 'Teilweise respiratorische Kompensation. Die psychiatrische Grunderkrankung muss behandelt werden, sonst rezidiviert die St√∂rung st√§ndig.',
          nursing: 'Einf√ºhlsame psychiatrische Betreuung ist essentiell. Elektrolyt-Substitution, besonders Kalium und Magnesium. EKG-Monitoring bei schwerer Hypokali√§mie. Zahn√§rztliche Kontrolle empfehlen, da Magens√§ure die Z√§hne sch√§digt. Ern√§hrungsberatung einbeziehen. Langfristig: psychotherapeutische Behandlung der Essst√∂rung. Cave: Bei schwerer Hypokali√§mie unter 2.5 station√§re Aufnahme erw√§gen.'
        }
      },
      {
        id: 40, mode: 'advanced', complexity: 'Advanced',
        context: 'Patient mit chronischer Niereninsuffizienz, bekommt seit Wochen hochdosiert Natriumbikarbonat oral.',
        ph: 7.49, pco2: 44, hco3: 33, be: 8, laktat: 1.1, na: 142, cl: 98, k: 4.2, glukose: 105,
        primary: 'MET_ALK', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Bei chronischer Niereninsuffizienz wird oft Bikarbonat gegeben, um die chronische metabolische Azidose zu behandeln. Wenn die Dosis zu hoch ist oder die Nierenfunktion sich unerwartet verbessert, kann eine iatrogene metabolische Alkalose entstehen. Dies ist ein klassisches Beispiel f√ºr eine √úbertherapie.',
          compensation: 'Teilweise respiratorische Kompensation durch Hypoventilation. Bei Patienten mit eingeschr√§nkter Lungenfunktion kann diese Kompensation problematisch sein.',
          nursing: 'Bikarbonat-Dosis reduzieren oder pausieren. Nierenfunktion kontrollieren, m√∂glicherweise hat sich die GFR verbessert. Elektrolyte √ºberwachen. Bei dialysepflichtigen Patienten: Dialysat-Bikarbonat-Konzentration anpassen. Diese Form der Alkalose ist gut therapierbar durch Dosisanpassung. Langfristig: Ziel-Bikarbonat bei CKD ist 22 bis 24 mmol pro Liter, nicht h√∂her.'
        }
      },
      {
        id: 41, mode: 'basic', complexity: 'Basis',
        context: 'Gesunder junger Patient zur Referenzmessung vor elektiver Operation, keine Vorerkrankungen.',
        ph: 7.40, pco2: 40, hco3: 24, be: 0, laktat: 1.0, na: 140, cl: 104, k: 4.0, glukose: 95,
        primary: 'NORMAL', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Dies ist eine normale BGA ohne pathologische Ver√§nderungen. Alle Parameter liegen im Referenzbereich. Der S√§ure-Basen-Haushalt ist perfekt ausgeglichen, die Lunge arbeitet effizient, die Nieren kompensieren ad√§quat. Dies dient als Referenzwert zum Vergleich mit pathologischen Befunden.',
          compensation: 'Keine Kompensation notwendig, da keine St√∂rung vorliegt. Der pH-Wert liegt exakt in der Mitte des Normbereichs bei 7.40. Sowohl respiratorische als auch metabolische Parameter sind optimal.',
          nursing: 'Pflegerelevant: Bei normalen BGA-Werten keine spezifischen Ma√ünahmen erforderlich. Wichtig ist zu lernen, normale Werte sicher zu erkennen und nicht zu √ºberinterpretieren. Nicht jede kleine Abweichung ist klinisch relevant. Der gesunde K√∂rper reguliert den S√§ure-Basen-Haushalt eigenst√§ndig perfekt.'
        }
      },
      {
        id: 42, mode: 'advanced', complexity: 'Advanced',
        context: 'Intensivpatient mit Pneumonie-Sepsis und gleichzeitiger Hypoventilation durch starke Sedierung.',
        ph: 7.10, pco2: 60, hco3: 18, be: -10, laktat: 4.0, na: 130, cl: 95, k: 5.8, glukose: 160,
        primary: 'P_MIXED', comp_basic: 'NONE', comp_advanced: 'C_MIXED',
        explanation: {
          pathophysiology: 'Dies ist eine lebensbedrohliche kombinierte Azidose mit beiden Komponenten gleichzeitig gest√∂rt. Die respiratorische Azidose entsteht durch Hypoventilation bei zu tiefer Sedierung oder Atemwegsverlegung. Die metabolische Azidose kommt von der Sepsis mit Gewebehypoxie und Laktatbildung. Beide St√∂rungen addieren sich und treiben den pH dramatisch in den kritischen Bereich unter 7.1.',
          compensation: 'Keine Kompensation m√∂glich, da beide Regulationssysteme versagen. Die Lunge kann die metabolische Azidose nicht kompensieren, weil sie selbst das Problem ist. Die Niere ist durch die Sepsis in ihrer Funktion eingeschr√§nkt. Dies ist ein medizinischer Notfall mit hoher Mortalit√§t.',
          nursing: 'Pflegerelevant: H√ñCHSTE NOTFALLSTUFE! Sofortige Eskalation an Intensivteam. Atemweg sichern, Beatmung optimieren oder einleiten. Sedierung reduzieren. Sepsis-Therapie intensivieren mit Antibiotika, Volumengabe, Katecholamine. Bei pH unter 7.1 ist die Herzfunktion massiv beeintr√§chtigt, Katecholamine wirken schlechter. Engmaschiges Monitoring aller Vitalparameter. Bikarbonat-Pufferung erw√§gen, aber prim√§r Ursachen beheben!'
        }
      },
      {
        id: 43, mode: 'advanced', complexity: 'Advanced',
        context: 'Patient mit Infekt, beginnende Sepsis, Tachypnoe 32 pro Minute, leichte Hypotonie, Laktat steigend.',
        ph: 7.50, pco2: 28, hco3: 22, be: 0, laktat: 3.5, na: 134, cl: 100, k: 3.4, glukose: 110,
        primary: 'RESP_ALK', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Bei beginnender Sepsis ist die respiratorische Alkalose oft ein Fr√ºhwarnzeichen, noch bevor die metabolische Azidose manifest wird. Entz√ºndungsmediatoren stimulieren das Atemzentrum und f√ºhren zu Hyperventilation. Das erh√∂hte Laktat von 3.5 zeigt bereits die beginnende Gewebehypoxie, aber das Bikarbonat ist noch normal. Dies ist das Fenster, in dem schnelles Handeln die Eskalation zur schweren Sepsis verhindern kann.',
          compensation: 'Noch keine Kompensation, die St√∂rung ist akut. Wichtig: In den n√§chsten Stunden wird sich wahrscheinlich eine metabolische Azidose entwickeln, wenn die Sepsis fortschreitet. Das Laktat ist der wichtigste Verlaufsparameter.',
          nursing: 'Pflegerelevant: Sepsis-Fr√ºhwarnung ernst nehmen! Sofortige Vitalparameter-Kontrolle, qSOFA-Score erheben. Blutkulturen abnehmen, dann Antibiotika nach Protokoll. Volumengabe starten. Laktat-Kontrollen alle zwei Stunden. Engmaschiges Monitoring von Blutdruck, Herzfrequenz, Atemfrequenz, Temperatur, Bewusstsein. Bei Verschlechterung: Intensivstation. Das Zeitfenster f√ºr erfolgreiche Therapie ist klein!'
        }
      },
      {
        id: 44, mode: 'advanced', complexity: 'Advanced',
        context: 'Patient mit schwerer Herzinsuffizienz und Bewusstseinstr√ºbung, Lungen√∂dem im R√∂ntgen, zus√§tzlich Fieber.',
        ph: 7.05, pco2: 70, hco3: 20, be: -8, laktat: 3.0, na: 142, cl: 102, k: 5.0, glukose: 150,
        primary: 'P_MIXED', comp_basic: 'NONE', comp_advanced: 'C_MIXED',
        explanation: {
          pathophysiology: 'Dies ist eine dramatische Kombination aus kardiogenem Lungen√∂dem mit CO‚ÇÇ-Retention und beginnender septischer Komponente. Das Lungen√∂dem behindert den Gasaustausch massiv, CO‚ÇÇ wird nicht mehr abgeatmet. Gleichzeitig f√ºhrt die kardiale Minderperfusion plus m√∂gliche Infektion zur metabolischen Azidose. Der pH von 7.05 ist kritisch und mit dem Leben kaum vereinbar.',
          compensation: 'Keine Kompensation, beide Systeme sind dekompensiert. Der Patient steht an der Schwelle zum Multiorganversagen. Die Bewusstseinstr√ºbung ist Folge der schweren Azidose und der zerebralen Minderperfusion.',
          nursing: 'Pflegerelevant: AKUT LEBENSBEDROHLICH! Reanimationsbereitschaft herstellen. Notfall-Intubation und Beatmung vorbereiten. Diuretika-Hochdosis zur √ñdem-Ausschwemmung. Katecholamine zur Kreislaufstabilisierung. Antibiotika bei Infektzeichen. Dieser Patient braucht sofortige intensivmedizinische Maximaltherapie. Familie informieren √ºber kritische Situation. Bei pH unter 7.1 ist die Prognose sehr schlecht, jede Minute z√§hlt.'
        }
      },
      {
        id: 45, mode: 'advanced', complexity: 'Advanced',
        context: 'Patient mit neuromuskul√§rer Erkrankung wie ALS, seit Jahren an invasiver Heimbeatmung, zur Routinekontrolle.',
        ph: 7.40, pco2: 55, hco3: 33, be: 8, laktat: 1.0, na: 139, cl: 98, k: 4.0, glukose: 105,
        primary: 'RESP_ACI', comp_basic: 'FULL', comp_advanced: 'MET_FULL',
        explanation: {
          pathophysiology: 'Bei Patienten mit chronischer neuromuskul√§rer Erkrankung und Langzeitbeatmung entwickelt sich oft ein individuelles Ziel-pCO‚ÇÇ, das h√∂her liegt als bei Gesunden. Die Atemmuskulatur ist durch die Grunderkrankung so schwach, dass eine Normalisierung des pCO‚ÇÇ nicht m√∂glich ist. Der K√∂rper hat sich √ºber Monate an dieses h√∂here CO‚ÇÇ-Level angepasst.',
          compensation: 'Vollst√§ndige metabolische Kompensation √ºber die Nieren. Das erh√∂hte Bikarbonat gleicht die respiratorische Azidose komplett aus, der pH ist wieder normal. Dies ist der neue Steady State f√ºr diesen Patienten. Eine Absenkung des pCO‚ÇÇ durch aggressivere Beatmung w√ºrde zu einer metabolischen Alkalose f√ºhren.',
          nursing: 'Pflegerelevant: Bei chronisch beatmeten Patienten ist das individuelle Ziel-pCO‚ÇÇ zu akzeptieren. Nicht jedes erh√∂hte pCO‚ÇÇ muss normalisiert werden. Wichtig: Kontrolle der Beatmungseinstellungen, Cuff-Druck pr√ºfen, Sekretmanagement. Verlaufsbeobachtung wichtiger als Einzelwerte. Bei stabiler Situation keine Panik, der Patient ist gut kompensiert. Schulung der Familie √ºber normale Werte ihres Angeh√∂rigen.'
        }
      },
      {
        id: 46, mode: 'advanced', complexity: 'Advanced',
        context: 'Tracheotomierter Patient mit pl√∂tzlichem Fieber, starke Sekretproduktion, zunehmend unruhig, SpO‚ÇÇ f√§llt ab.',
        ph: 7.20, pco2: 80, hco3: 36, be: 10, laktat: 1.5, na: 138, cl: 95, k: 5.0, glukose: 140,
        primary: 'RESP_ACI', comp_basic: 'PARTIAL', comp_advanced: 'MET_PARTIAL',
        explanation: {
          pathophysiology: 'Bei tracheotomierten Patienten kann ein Sekretstau innerhalb von Minuten zu kritischer Atemwegsverlegung f√ºhren. Das z√§he Sekret bei Fieber und Infektion verlegt die Trachealkan√ºle oder die unteren Atemwege. Das CO‚ÇÇ steigt dramatisch an. Dies ist eine akute Verschlechterung bei einem Patienten, der zuvor chronisch kompensiert war. Das hohe pCO‚ÇÇ von 80 mmHg ist lebensbedrohlich.',
          compensation: 'Das hohe Bikarbonat zeigt die chronische Vorgeschichte, aber die aktuelle Azidose mit pH 7.20 zeigt die akute Dekompensation. Die bestehende Kompensation reicht nicht mehr aus.',
          nursing: 'Pflegerelevant: NOTFALL bei Trachealkan√ºle! Sofortige Intervention erforderlich. Endotracheales Absaugen, eventuell Trachealkan√ºle wechseln wenn verlegt. Sauerstoff-Gabe erh√∂hen. Lagerung optimieren. Inhalation mit NaCl zur Sekretolyse. Antibiotika bei Infektzeichen. Bei Verschlechterung: Notarzt rufen. Dies ist ein Klassiker in der au√üerklinischen Intensivpflege - schnelles Erkennen rettet Leben!'
        }
      },
      {
        id: 47, mode: 'advanced', complexity: 'Advanced',
        context: 'Beatmeter Patient mit bekannter Trachealkan√ºle, nun hypotone Kreislaufsituation, Oligurie, Fieber.',
        ph: 7.15, pco2: 45, hco3: 16, be: -10, laktat: 7.5, na: 135, cl: 90, k: 5.5, glukose: 300,
        primary: 'MET_ACI', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Dies ist eine schwere metabolische Azidose mit sehr hohem Laktat von 7.5, was auf septischen Schock hindeutet. Die erh√∂hte Anionenl√ºcke durch Laktat ist charakteristisch. Die Hyperglyk√§mie entsteht durch Stress und Insulinresistenz bei Sepsis. Die Hyperkali√§mie kommt durch die Azidose und beginnende Nierenfunktionsst√∂rung. Der Patient ist vital bedroht.',
          compensation: 'Teilweise respiratorische Kompensation, aber insuffizient bei so hohem Laktat. Das pCO‚ÇÇ ist im oberen Normbereich statt niedrig, was darauf hindeutet, dass die Atemreserve ersch√∂pft ist.',
          nursing: 'Pflegerelevant: SEPTISCHER SCHOCK! Sofortige Eskalation. Sepsis-Bundle: Blutkulturen, Antibiotika innerhalb einer Stunde, aggressive Volumengabe 30 ml pro kg. Noradrenalin bei persistierender Hypotonie. Fokus-Sanierung, wahrscheinlich Pneumonie bei beatmetem Patienten. Laktat-Kontrollen alle 2 Stunden als Verlaufsparameter. Blutzucker-Management. Hyperkali√§mie-Monitoring am EKG. Bei Laktat √ºber 4 ist die Mortalit√§t sehr hoch.'
        }
      },
      {
        id: 48, mode: 'basic', complexity: 'Basis',
        context: 'Beatmungspatient, seit heute Morgen zunehmend unruhig, Alarm wegen Hyperventilation, SpO‚ÇÇ 100 Prozent.',
        ph: 7.55, pco2: 30, hco3: 24, be: 0, laktat: 1.0, na: 142, cl: 100, k: 4.2, glukose: 100,
        primary: 'RESP_ALK', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Dies ist eine iatrogene respiratorische Alkalose durch fehlerhafte Beatmungseinstellung. Das Atemzugvolumen ist zu hoch oder die Atemfrequenz zu hoch eingestellt, sodass zu viel CO‚ÇÇ abgeatmet wird. Die Unruhe des Patienten kann durch die Alkalose selbst verursacht sein, aber auch Ausl√∂ser f√ºr geh√§uftes Triggern der Beatmung sein. Eine √úberbeatmung ist potenziell gef√§hrlich.',
          compensation: 'Keine Kompensation bei akuter St√∂rung. Das Bikarbonat ist noch normal, da die Nieren Zeit brauchen um zu reagieren.',
          nursing: 'Pflegerelevant: Beatmungseinstellungen SOFORT √ºberpr√ºfen und korrigieren. Atemzugvolumen oder Frequenz reduzieren. Ursache der Unruhe abkl√§ren: Schmerzen, Angst, volle Blase, Lagerung unbequem. Sedierung nur als letzte Option, erst alle anderen Ursachen ausschlie√üen. Eine chronische √úberbeatmung kann sp√§ter zu Apnoen f√ºhren, wenn der Patient an niedrige CO‚ÇÇ-Werte gew√∂hnt ist. Ziel: normales pCO‚ÇÇ anstreben.'
        }
      },
      {
        id: 49, mode: 'advanced', complexity: 'Advanced',
        context: 'Langzeitbeatmeter Patient mit Herzinsuffizienz, erh√§lt hochdosierte Schleifendiuretika seit Wochen.',
        ph: 7.47, pco2: 35, hco3: 28, be: 4, laktat: 1.0, na: 145, cl: 100, k: 3.0, glukose: 95,
        primary: 'MET_ALK', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Schleifendiuretika wie Furosemid f√ºhren bei Langzeitgabe zu einem massiven Verlust von Chlorid und Kalium √ºber die Niere. Dies ist eine kontraktions-alkalose durch Volumenmangel. Der Chlorid-Verlust ist der Hauptmechanismus. Die chronische Diuretika-Therapie bei beatmeten Patienten mit Herzinsuffizienz ist eine h√§ufige Ursache f√ºr metabolische Alkalose in der Langzeitpflege.',
          compensation: 'Teilweise respiratorische Kompensation durch leichte Hypoventilation. Bei beatmeten Patienten ist diese Kompensation durch die Beatmungseinstellung limitiert.',
          nursing: 'Pflegerelevant: Diuretika-Dosis mit Arzt besprechen, eventuell reduzieren oder Kalium-sparende Diuretika erg√§nzen. Aggressive Kalium-Substitution notwendig, Ziel √ºber 4.0 mmol pro Liter. Chlorid-Gabe erw√§gen als NaCl-Infusion. Magnesium kontrollieren und substituieren. Bei beatmeten Patienten: Beatmungseinstellung eventuell anpassen. Fl√ºssigkeitsbilanz f√ºhren. EKG-Monitoring bei Hypokali√§mie obligat.'
        }
      },
      {
        id: 50, mode: 'advanced', complexity: 'Advanced',
        context: 'COPD-Patient mit Cor pulmonale, periphere √ñdeme, Halsvenen gestaut, zunehmende Belastungsdyspnoe.',
        ph: 7.32, pco2: 58, hco3: 30, be: 4, laktat: 1.6, na: 132, cl: 98, k: 3.2, glukose: 118,
        primary: 'RESP_ACI', comp_basic: 'PARTIAL', comp_advanced: 'MET_PARTIAL',
        explanation: {
          pathophysiology: 'Bei langj√§hriger COPD f√ºhrt chronische Hypoxie zur pulmonalen Hypertonie und Rechtsherzbelastung, dem sogenannten Cor pulmonale. Die Herzinsuffizienz verschlechtert die Lungenfunktion zus√§tzlich. Die Hyponatri√§mie und Hypokali√§mie sind typisch bei Herzinsuffizienz mit Diuretika-Therapie. Dies ist ein Teufelskreis aus Lungen- und Herzerkrankung.',
          compensation: 'Metabolische Teilkompensation. Auff√§llig: Hyponatri√§mie von 132 und Hypokali√§mie von 3.2, typisch bei Herzinsuffizienz mit Diuretika. Die Elektrolytst√∂rungen k√∂nnen Arrhythmien beg√ºnstigen.',
          nursing: 'Pflegerelevant: Sorgf√§ltige Bilanzierung, Cave √úberw√§sserung. Diuretika nach Plan, aber Elektrolytsubstitution nicht vergessen, besonders Kalium. Oberk√∂rperhochlagerung. Bei Verschlechterung: NIV plus Herzinsuffizienz-Therapie optimieren. Gewichtskontrolle t√§glich. Bein√∂deme dokumentieren. Sauerstoff-Gabe vorsichtig dosieren, Ziel SpO‚ÇÇ 88 bis 92 Prozent bei COPD. EKG-Monitoring bei Elektrolytst√∂rungen.'
        }
      },
      {
        id: 51, mode: 'basic', complexity: 'Basis',
        context: 'Heimbeatmeter Patient, Angeh√∂rige berichtet √ºber zunehmende Tagesm√ºdigkeit und morgendliche Kopfschmerzen.',
        ph: 7.34, pco2: 56, hco3: 30, be: 4, laktat: 1.1, na: 140, cl: 103, k: 4.0, glukose: 105,
        primary: 'RESP_ACI', comp_basic: 'PARTIAL', comp_advanced: 'MET_PARTIAL',
        explanation: {
          pathophysiology: 'Bei heimbeatmeten Patienten kann eine schleichende Unterventilation entstehen, wenn die Beatmungseinstellungen nicht mehr optimal sind. M√∂gliche Ursachen sind Gewichtszunahme, Krankheitsprogression, Leckagen am Interface oder technische Probleme der Beatmungsmaschine. Die morgendlichen Kopfschmerzen sind ein typisches Zeichen f√ºr n√§chtliche CO‚ÇÇ-Retention, die sogenannte CO‚ÇÇ-Narkose-Symptomatik.',
          compensation: 'Teilweise metabolische Kompensation durch die Nieren, erkennbar am erh√∂hten Bikarbonat. Dies zeigt, dass die Unterventilation schon seit Tagen bis Wochen besteht, nicht erst seit heute. Der K√∂rper versucht zu kompensieren, aber es reicht nicht mehr aus.',
          nursing: 'Pflegerelevant: Beatmungsger√§t √ºberpr√ºfen auf Funktion und Einstellungen. Masken-Sitz kontrollieren, Leckagen ausschlie√üen. Befeuchtungssystem pr√ºfen. Atemzugvolumen oder Beatmungsdruck eventuell erh√∂hen nach R√ºcksprache mit Arzt oder Beatmungstherapeut. Download der Ger√§tedaten zur Auswertung. Bei Verschlechterung: Pneumologen oder Beatmungszentrum kontaktieren. Schulung der Familie √ºber Warnzeichen.'
        }
      },
      {
        id: 52, mode: 'basic', complexity: 'Basis',
        context: 'Patient mit Tracheostoma in h√§uslicher Pflege, seit gestern vermehrtes gelblich-gr√ºnes Trachealsekret, Fieber 38.2¬∞C.',
        ph: 7.29, pco2: 54, hco3: 26, be: 0, laktat: 1.8, na: 138, cl: 104, k: 4.3, glukose: 135,
        primary: 'RESP_ACI', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Bei tracheotomierten Patienten ist das Risiko f√ºr Atemwegsinfektionen erh√∂ht, da die nat√ºrlichen Abwehrmechanismen der oberen Atemwege umgangen werden. Das purulente Sekret und Fieber deuten auf eine bakterielle Tracheobronchitis oder beginnende Pneumonie hin. Die Infektion f√ºhrt zu Bronchospasmus, Sekretverlegung und damit zu Hypoventilation mit CO‚ÇÇ-Retention.',
          compensation: 'Keine Kompensation bei akutem Infektgeschehen. Das leicht erh√∂hte Laktat deutet auf eine beginnende systemische Entz√ºndungsreaktion hin.',
          nursing: 'Pflegerelevant: Sekretabnahme f√ºr Mikrobiologie vor Antibiotika-Gabe. Intensivierung der Inhalationstherapie mit NaCl und eventuell Bronchodilatatoren. Endotracheales Absaugen nach Bedarf, aber nicht zu h√§ufig um Schleimhautreizung zu vermeiden. Antibiotika nach √§rztlicher Anordnung. Fiebersenkung. Fl√ºssigkeitszufuhr erh√∂hen zur Sekretverfl√ºssigung. Oberk√∂rperhochlagerung. Bei Verschlechterung mit steigendem pCO‚ÇÇ oder Bewusstseinstr√ºbung: Klinikeinweisung erw√§gen.'
        }
      },
      {
        id: 53, mode: 'basic', complexity: 'Basis',
        context: 'Heimbeatmeter ALS-Patient, Angeh√∂rige hat aus Versehen das Atemzugvolumen erh√∂ht, Patient klagt √ºber Schwindel.',
        ph: 7.49, pco2: 32, hco3: 24, be: 0, laktat: 0.9, na: 141, cl: 105, k: 3.9, glukose: 98,
        primary: 'RESP_ALK', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Bei versehentlich erh√∂htem Atemzugvolumen wird der Patient √ºberbeatmet. Es wird mehr CO‚ÇÇ abgeatmet als produziert, was zur akuten respiratorischen Alkalose f√ºhrt. Der Schwindel entsteht durch zerebrale Vasokonstriktion bei niedrigem CO‚ÇÇ, was die Hirndurchblutung reduziert. Dies ist ein h√§ufiger iatrogener Fehler in der h√§uslichen Beatmung.',
          compensation: 'Keine Kompensation bei akutem Ereignis. Das Bikarbonat ist noch im Normbereich.',
          nursing: 'Pflegerelevant: Beatmungseinstellungen SOFORT auf die Ausgangswerte zur√ºcksetzen. Dokumentation der korrekten Einstellungen f√ºr die Familie sichtbar anbringen. Einweisung der Angeh√∂rigen wiederholen, wie wichtig korrekte Einstellungen sind. Kindersicherung am Beatmungsger√§t aktivieren falls m√∂glich. Dieser Fall zeigt, wie wichtig regelm√§√üige Schulungen der pflegenden Angeh√∂rigen sind. Bei persistierenden Symptomen nach Korrektur: telefonische R√ºcksprache mit Beatmungszentrum.'
        }
      },
      {
        id: 54, mode: 'advanced', complexity: 'Advanced',
        context: 'Langzeitbeatmeter Patient, seit Wochen kaum Fl√ºssigkeitsaufnahme wegen Schluckst√∂rung, zunehmend verwirrt.',
        ph: 7.48, pco2: 42, hco3: 31, be: 6, laktat: 1.2, na: 152, cl: 110, k: 3.3, glukose: 125,
        primary: 'MET_ALK', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Bei unzureichender Fl√ºssigkeitszufuhr entsteht eine Dehydratation mit Hypernatri√§mie von 152. Die Kontraktionsalkalose durch Volumenmangel f√ºhrt zur metabolischen Alkalose. Die Nieren scheiden bei Volumenmangel weniger Bikarbonat aus um Natrium zu sparen, was die Alkalose verst√§rkt. Die Hyperchlor√§mie und Hypokali√§mie sind typisch. Die Verwirrtheit ist Folge der Hypernatri√§mie und Dehydratation, besonders gef√§hrlich bei √§lteren Patienten.',
          compensation: 'Teilweise respiratorische Kompensation durch leichte Hypoventilation. Bei beatmeten Patienten ist diese Kompensation limitiert.',
          nursing: 'Pflegerelevant: Fl√ºssigkeitsbilanz f√ºhren und Fl√ºssigkeitszufuhr drastisch erh√∂hen, ideal √ºber PEG-Sonde falls vorhanden, sonst vorsichtige orale Fl√ºssigkeitsgabe oder intraven√∂se Rehydratation erw√§gen. Vorsicht bei zu schneller Korrektur der Hypernatri√§mie, maximal 10 mmol pro Liter pro Tag senken um osmotisches Demyelinisierungssyndrom zu vermeiden. Elektrolyt-Substitution besonders Kalium. Hautpflege intensivieren bei Dehydratation. Schulung der Familie √ºber ausreichende Fl√ºssigkeitszufuhr, eventuell PEG-Anlage besprechen bei persistierender Dysphagie.'
        }
      },
      {
        id: 55, mode: 'advanced', complexity: 'Advanced',
        context: 'Heimbeatmeter Patient mit Aspirationspneumonie, antibiotisch anbehandelt, jetzt zunehmend dyspnoisch trotz Sauerstoff.',
        ph: 7.32, pco2: 48, hco3: 24, be: -1, laktat: 2.8, na: 136, cl: 102, k: 4.5, glukose: 165,
        primary: 'RESP_ACI', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Die Aspirationspneumonie bei beatmeten Patienten ist eine gef√ºrchtete Komplikation. Aspirierter Mageninhalt sch√§digt die Lunge chemisch und bakteriell. Trotz Antibiotika-Therapie verschlechtert sich die Lungenfunktion, die Inflammation reduziert die Compliance. Das erh√∂hte Laktat von 2.8 deutet auf eine zunehmende Hypoxie und beginnende Sepsis hin. Die Hyperglyk√§mie ist Stressreaktion.',
          compensation: 'Keine metabolische Kompensation bei akutem Geschehen. Das pCO‚ÇÇ steigt trotz vermehrter Atemanstrengung, was ein schlechtes Zeichen ist und auf respiratorische Ersch√∂pfung hindeutet.',
          nursing: 'Pflegerelevant: DRINGEND √§rztliche Evaluation, eventuell Klinikeinweisung notwendig. R√∂ntgen-Thorax zum Ausschluss von Komplikationen wie Pleuraerguss oder ARDS. Antibiotika-Therapie evaluieren, eventuell Eskalation. Beatmungsunterst√ºtzung intensivieren, h√∂herer Beatmungsdruck oder Frequenz. Aspirationsprophylaxe √ºberpr√ºfen: Oberk√∂rperhochlagerung mindestens 30 Grad, Cuff-Druck kontrollieren, Nahrungszufuhr √ºber PEG optimieren, Magensonde auf richtige Lage pr√ºfen. Bei weiter steigendem Laktat: septischer Schock, Intensivstation erforderlich.'
        }
      },
      {
        id: 56, mode: 'basic', complexity: 'Basis',
        context: 'Patient mit neuer Heimbeatmung, erste Woche zu Hause, klagt √ºber Bauchschmerzen und V√∂llegef√ºhl nach Mahlzeiten.',
        ph: 7.51, pco2: 46, hco3: 36, be: 10, laktat: 0.9, na: 139, cl: 95, k: 3.2, glukose: 100,
        primary: 'MET_ALK', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Bei Beatmungspatienten kann es zu Aerophagie kommen, dem Verschlucken von Luft, besonders bei nicht-invasiver Beatmung mit Maske. Die verschluckte Luft f√ºhrt zu Magen√ºberbl√§hung und reflexartig zu Erbrechen oder Aufsto√üen. Wenn saurer Mageninhalt verloren geht, entsteht eine metabolische Alkalose. Die Hypokali√§mie und Hypochlor√§mie sind typisch. Die Bauchschmerzen entstehen durch die √úberdehnung des Magens.',
          compensation: 'Teilweise respiratorische Kompensation durch Hypoventilation, erkennbar am etwas erh√∂hten pCO‚ÇÇ.',
          nursing: 'Pflegerelevant: Beatmungsmaske √ºberpr√ºfen auf korrekten Sitz und Druck, eventuell auf andere Maskengr√∂√üe oder Maskentyp wechseln. Kleinere, h√§ufigere Mahlzeiten statt gro√üer Portionen. Langsam essen lassen, gut kauen. Oberk√∂rperhochlagerung nach Mahlzeiten. Medikamente zur Reduktion der Magens√§ureproduktion erw√§gen. Kalium-Substitution. Bei persistierenden Beschwerden: PEG-Anlage diskutieren um orale Nahrungsaufnahme zu vermeiden. Dies ist ein h√§ufiges Problem in der Anpassungsphase an die Heimbeatmung.'
        }
      },
      {
        id: 57, mode: 'advanced', complexity: 'Advanced',
        context: 'Beatmungspatient unter Langzeit-Cortisontherapie wegen COPD, seit drei Tagen Halsschmerzen, jetzt Luftnot und Fieber.',
        ph: 7.24, pco2: 62, hco3: 26, be: 0, laktat: 3.2, na: 144, cl: 108, k: 5.1, glukose: 285,
        primary: 'RESP_ACI', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Patienten unter Langzeit-Cortison-Therapie sind immunsupprimiert und haben ein erh√∂htes Infektionsrisiko. Die Halsschmerzen waren wahrscheinlich erstes Zeichen einer Infektion, die sich jetzt zur schweren Tracheobronchitis oder Pneumonie entwickelt hat. Die Hyperglyk√§mie entsteht durch die Cortison-Therapie plus Stress der Infektion. Das erh√∂hte Laktat deutet auf beginnende Sepsis hin. Die CO‚ÇÇ-Retention zeigt die schwere Atemwegsverlegung.',
          compensation: 'Keine Kompensation bei akuter Infektion. Der Patient ist kritisch und braucht sofortige Intervention.',
          nursing: 'Pflegerelevant: NOTFALL! Sofortige Klinikeinweisung erforderlich. Blutkulturen und Sputum f√ºr Mikrobiologie abnehmen. Breitspektrum-Antibiotika nach Anordnung. Bei immunsupprimierten Patienten auch an opportunistische Erreger denken wie Pilze oder Pneumocystis. Blutzucker-Management, eventuell Insulin-Therapie. Intensivierung der Beatmungsunterst√ºtzung. Bei Patienten unter Langzeit-Cortison: Bei jedem Infektzeichen fr√ºhzeitig reagieren, da Infektionen schnell lebensbedrohlich werden k√∂nnen. Cave: Cortison nicht abrupt absetzen, Stress-Dosierung eventuell erh√∂hen.'
        }
      },
      {
        id: 58, mode: 'basic', complexity: 'Basis',
        context: 'Heimbeatmungspatient, Stromausfall in der Nacht f√ºr zwei Stunden, Notfallbeatmung mit Ambubeutel durch Angeh√∂rige.',
        ph: 7.33, pco2: 52, hco3: 27, be: 1, laktat: 1.5, na: 139, cl: 103, k: 4.2, glukose: 130,
        primary: 'RESP_ACI', comp_basic: 'PARTIAL', comp_advanced: 'MET_PARTIAL',
        explanation: {
          pathophysiology: 'Bei Stromausfall und manueller Notfallbeatmung mit Ambubeutel ist es sehr schwierig, eine ad√§quate Ventilation aufrecht zu erhalten. Meist wird zu wenig Volumen oder zu selten beatmet, was zur CO‚ÇÇ-Retention f√ºhrt. Die manuelle Beatmung √ºber zwei Stunden ist f√ºr Angeh√∂rige extrem anstrengend. Das leicht erh√∂hte Laktat und die Hyperglyk√§mie zeigen die Stress-Situation f√ºr den Patienten.',
          compensation: 'Beginnende metabolische Kompensation, das Bikarbonat ist leicht erh√∂ht. Dies zeigt, dass die Unterventilation √ºber mehrere Stunden bestand.',
          nursing: 'Pflegerelevant: Nach Wiederherstellung der Stromversorgung und R√ºckkehr zur maschinellen Beatmung den Patienten engmaschig √ºberwachen. BGA-Kontrolle war hier richtig um das Ausma√ü der Hyperkapnie zu erfassen. Wichtige Lernpunkte: Notfallplan mit der Familie durchgehen, Notstromaggregat oder batteriebetriebenes Beatmungsger√§t als Backup organisieren. Schulung der Angeh√∂rigen in manueller Beatmung ist essentiell. Ambubeutel muss immer griffbereit sein. Kontakt zum Energieversorger herstellen um bei Patienten mit lebenserhaltenden Ger√§ten vorrangige Wiederherstellung zu gew√§hrleisten.'
        }
      },
      {
        id: 59, mode: 'advanced', complexity: 'Advanced',
        context: 'Langzeitbeatmeter Patient mit Dekubitus Grad 3 am Stei√übein, seit Tagen zunehmende Wundverschlechterung, Geruch.',
        ph: 7.29, pco2: 38, hco3: 18, be: -7, laktat: 4.2, na: 135, cl: 98, k: 5.2, glukose: 175,
        primary: 'MET_ACI', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Der infizierte Dekubitus ist Ausgangspunkt einer Sepsis. Bakterien aus der nekrotischen Wunde gelangen in die Blutbahn und f√ºhren zur systemischen Entz√ºndungsreaktion. Das hohe Laktat von 4.2 zeigt die Gewebehypoxie und septische Komponente. Die metabolische Azidose entsteht durch die Laktatakkumulation. Der √ºble Geruch deutet auf anaerobe Bakterien hin, die besonders aggressiv sind.',
          compensation: 'Teilweise respiratorische Kompensation, aber insuffizient bei so hohem Laktat. Die Hyperkali√§mie ist Folge der Azidose und kann zu Herzrhythmusst√∂rungen f√ºhren.',
          nursing: 'Pflegerelevant: SEPTISCHER NOTFALL ausgehend von Dekubitus! Sofortige Klinikeinweisung f√ºr chirurgisches Debridement notwendig. Blutkulturen und Wundabstrich vor Antibiotika. Breitspektrum-Antibiotika gegen Anaerobier. Volumengabe, eventuell Katecholamine. Dies zeigt: Dekubitusprophylaxe und fr√ºhzeitige Wundversorgung sind √ºberlebenswichtig bei immobilen Beatmungspatienten. Lagerung alle zwei Stunden, Wechseldruckmatratze, Hautpflege, Ern√§hrungsstatus optimieren. EKG-Monitoring wegen Hyperkali√§mie. Dieser Fall h√§tte durch konsequente Prophylaxe verhindert werden k√∂nnen.'
        }
      },
      {
        id: 60, mode: 'advanced', complexity: 'Advanced',
        context: 'Heimbeatmeter Patient, Angeh√∂rige vergessen seit einer Woche die abendliche Medikamentengabe inkl. Protonenpumpenhemmer.',
        ph: 7.33, pco2: 40, hco3: 21, be: -3, laktat: 1.1, na: 138, cl: 106, k: 4.8, glukose: 102,
        primary: 'MET_ACI', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Ohne Protonenpumpenhemmer bei beatmeten Patienten steigt das Risiko f√ºr Stressulcera im Magen dramatisch. Die vermehrte Magens√§ureproduktion kann zu okkulten Blutungen f√ºhren. Bei Blutungen im oberen Gastrointestinaltrakt wird H√§moglobin zu Harnstoff abgebaut, was zur metabolischen Azidose f√ºhrt. Die Hyperchlor√§mie deutet auf eine hyperchlor√§mische Azidose hin. Die Azidose ist noch mild, aber das Problem kann sich schnell verschlechtern.',
          compensation: 'Keine Kompensation erkennbar bei dieser milden Azidose. Wichtig ist hier die fr√ºhzeitige Erkennung bevor es zu massiven Blutungen kommt.',
          nursing: 'Pflegerelevant: Medikamentenplan √ºberpr√ºfen und mit Angeh√∂rigen besprechen. Protonenpumpenhemmer SOFORT wieder ansetzen. Kontrolle auf Zeichen gastrointestinaler Blutung: Teerstuhl, H√§matemesis, An√§mie-Zeichen wie Bl√§sse oder Tachykardie. Stuhl auf okkultes Blut testen. Bei beatmeten Patienten ist die Stress-Ulkus-Prophylaxe essentiell und darf niemals vergessen werden. Medikamentendispenser f√ºr die Familie organisieren zur Vermeidung solcher Fehler. Regelm√§√üige H√§moglobin-Kontrollen bei Risikopatienten. Dies zeigt wie wichtig strukturierte Medikamentengabe und Schulung der Angeh√∂rigen sind.'
        }
      }
    ];

    let currentIndex = 0;
    let currentMode = 'basic';

    const inputs = {
      ph: document.getElementById('ph'),
      pco2: document.getElementById('pco2'),
      hco3: document.getElementById('hco3'),
      be: document.getElementById('be'),
      laktat: document.getElementById('laktat'),
      na: document.getElementById('na'),
      cl: document.getElementById('cl'),
      k: document.getElementById('k'),
      glukose: document.getElementById('glukose')
    };

    const advancedContainer = document.getElementById('advanced-values-container');
    const primaryFieldset = document.getElementById('primary-fieldset');
    const compBasicFieldset = document.getElementById('comp-basic-fieldset');
    const compAdvancedFieldset = document.getElementById('comp-advanced-fieldset');
    const pMixedLi = document.getElementById('p-mixed-li');
    const modeChip = document.getElementById('mode-chip');
    const explainWrap = document.getElementById('explain-wrap');
    const clinicalExplanationContainer = document.getElementById('clinical-explanation-container');
    const clinicalExplanationText = document.getElementById('clinical-explanation-text');

    function setAmpelColor(key, value) {
      const item = document.getElementById('item-' + key);
      if (!item) return;
      item.classList.remove('norm-green', 'norm-red', 'norm-blue');
      const norm = NORMBEREICHE[key];
      if (!norm) return;
      if (value >= norm.min && value <= norm.max) {
        item.classList.add('norm-green');
      } else if (key === 'ph' || key === 'pco2' || key === 'be' || key === 'laktat') {
        item.classList.add('norm-red');
      } else {
        item.classList.add('norm-blue');
      }
    }

    function getRandomCase() {
      let available = CASES;
      if (currentMode === 'basic') {
        available = CASES.filter(c => c.mode === 'basic');
      } else if (currentMode === 'advanced') {
        available = CASES.filter(c => c.mode === 'advanced');
      }
      const filtered = available.filter((c, idx) => CASES.indexOf(c) !== currentIndex);
      if (filtered.length === 0) return Math.floor(Math.random() * available.length);
      const randomCase = filtered[Math.floor(Math.random() * filtered.length)];
      return CASES.indexOf(randomCase);
    }

    function renderCase(index) {
      if (index === -1) index = getRandomCase();
      const c = CASES[index];
      if (!c) return;
      currentIndex = index;
      
      for (const key in inputs) {
        if (inputs[key] && c[key] != null) {
          inputs[key].value = c[key].toFixed(key === 'ph' ? 2 : 1);
          setAmpelColor(key, c[key]);
        }
      }

      document.getElementById('case-id').textContent = c.id;
      document.getElementById('case-complexity').textContent = c.complexity;
      document.getElementById('case-complexity').className = 'text-xs px-2 py-1 rounded-full ' + 
        (c.complexity === 'Basis' ? 'bg-green-100 text-green-800' : 'bg-orange-100 text-orange-800');
      document.getElementById('clinical-context').textContent = c.context;

      primaryFieldset.querySelectorAll('input').forEach(r => r.checked = false);
      compBasicFieldset.querySelectorAll('input').forEach(r => r.checked = false);
      compAdvancedFieldset.querySelectorAll('input').forEach(r => r.checked = false);
      compBasicFieldset.disabled = true;
      compAdvancedFieldset.disabled = true;

      explainWrap.open = false;
      document.getElementById('status-dot').style.backgroundColor = '#9ca3af';
      document.getElementById('result-text').textContent = 'Bitte Werte auswerten';
      document.getElementById('explanation').textContent = 'Bitte w√§hle prim√§re St√∂rung und Kompensation.';
      clinicalExplanationContainer.classList.add('hidden');
    }

    function handleModeChange() {
      const newMode = document.querySelector('input[name="mode"]:checked').value;
      currentMode = newMode;
      
      if (currentMode === 'basic') {
        modeChip.textContent = 'BASIS MODUS';
        advancedContainer.classList.add('hidden');
        compBasicFieldset.style.display = 'block';
        compAdvancedFieldset.style.display = 'none';
        pMixedLi.classList.add('hidden');
      } else if (currentMode === 'advanced') {
        modeChip.textContent = 'ADVANCED MODUS';
        advancedContainer.classList.remove('hidden');
        compBasicFieldset.style.display = 'none';
        compAdvancedFieldset.style.display = 'block';
        pMixedLi.classList.remove('hidden');
      } else {
        modeChip.textContent = 'MIXED MODUS';
        advancedContainer.classList.remove('hidden');
        compBasicFieldset.style.display = 'none';
        compAdvancedFieldset.style.display = 'block';
        pMixedLi.classList.remove('hidden');
      }
    }

    function handlePrimarySelection() {
      const primary = document.querySelector('input[name="primary"]:checked');
      if (!primary) {
        compBasicFieldset.disabled = true;
        compAdvancedFieldset.disabled = true;
        return;
      }
      if (primary.value === 'NORMAL') {
        compBasicFieldset.disabled = true;
        compAdvancedFieldset.disabled = true;
        document.getElementById('c-none').checked = true;
        document.getElementById('ca-none').checked = true;
      } else {
        if (currentMode === 'basic') {
          compBasicFieldset.disabled = false;
        } else {
          compAdvancedFieldset.disabled = false;
        }
      }
    }

    function getLabel(key) {
      const labels = {
        NORMAL: 'Normal', RESP_ACI: 'Respiratorische Azidose', RESP_ALK: 'Respiratorische Alkalose',
        MET_ACI: 'Metabolische Azidose', MET_ALK: 'Metabolische Alkalose', P_MIXED: 'Gemischte St√∂rung',
        NONE: 'Keine Kompensation', PARTIAL: 'Teilweise Kompensation', FULL: 'Vollst√§ndige Kompensation',
        RESP_PARTIAL: 'Respiratorische Teil-Kompensation', MET_PARTIAL: 'Metabolische Teil-Kompensation',
        RESP_FULL: 'Respiratorische Voll-Kompensation', MET_FULL: 'Metabolische Voll-Kompensation',
        C_MIXED: 'Gemischte St√∂rung'
      };
      return labels[key] || key;
    }

    document.querySelectorAll('input[name="mode"]').forEach(radio => {
      radio.addEventListener('change', () => {
        handleModeChange();
        renderCase(-1);
      });
    });

    primaryFieldset.addEventListener('change', handlePrimarySelection);

    document.getElementById('evalbutton').addEventListener('click', () => {
      const c = CASES[currentIndex];
      const primaryEl = document.querySelector('input[name="primary"]:checked');
      const compKey = currentMode === 'basic' ? 'comp_basic' : 'comp_advanced';
      const compEl = document.querySelector('input[name="' + compKey + '"]:checked');
      
      if (!primaryEl || !compEl) {
        alert('Bitte w√§hle beide Optionen aus!');
        return;
      }

      // Speichere den Versuch im LearningManager
      const isCorrect = LearningManager.saveAttempt(
        c.id,
        primaryEl.value,
        compEl.value,
        c.primary,
        c[compKey],
        currentMode
      );
      
      // Aktualisiere Progress Badge
      updateProgressBadge();
      
      // Aktualisiere UI
      document.getElementById('status-dot').style.backgroundColor = isCorrect ? '#16a34a' : '#ef4444';
      document.getElementById('result-text').textContent = isCorrect ? 'Korrekt ‚úì' : 'Nicht korrekt ‚úó';
      
      // Zeige Erkl√§rung
      let explanationHTML = '<p><strong>Richtige Antwort:</strong> ' + getLabel(c.primary) + ', ' + getLabel(c[compKey]) + '</p>';
      
      // F√ºge personalisiertes Feedback hinzu (Sprint 1 Basis-Version)
      const stats = LearningManager.getBasicStats();
      if (!isCorrect && stats.totalAttempts > 5) {
        explanationHTML += '<p style="margin-top: 12px; padding: 8px; background-color: #FEF3C7; border-radius: 6px; font-size: 0.875rem;">';
        explanationHTML += 'üí° <strong>Tipp:</strong> Du hast jetzt ' + stats.totalAttempts + ' F√§lle bearbeitet mit ' + stats.successRate + '% Erfolgsquote. ';
        if (stats.successRate < 60) {
          explanationHTML += 'Lass dir Zeit bei der Analyse und nutze den Normwerte-Spickzettel!';
        } else {
          explanationHTML += 'Du machst gute Fortschritte, bleib dran!';
        }
        explanationHTML += '</p>';
      }
      
      document.getElementById('explanation').innerHTML = explanationHTML;
      explainWrap.open = true;

      if (c.explanation) {
        clinicalExplanationText.innerHTML = 
          '<p class="mb-2"><strong>Pathophysiologie:</strong><br>' + c.explanation.pathophysiology + '</p>' +
          '<p class="mb-2"><strong>Kompensation:</strong><br>' + c.explanation.compensation + '</p>' +
          '<p><strong>Pflegerisch:</strong><br>' + c.explanation.nursing + '</p>';
        clinicalExplanationContainer.classList.remove('hidden');
      }
    });

    document.getElementById('nextcasebutton').addEventListener('click', () => {
      renderCase(-1);
    });

    document.getElementById('resetbutton').addEventListener('click', () => {
      renderCase(currentIndex);
    });

    window.onload = () => {
      // Initialisiere Learning Manager
      LearningManager.init();
      
      // Zeige Willkommensnachricht mit Statistiken
      showWelcomeMessage();
      
      handleModeChange();
      renderCase(-1);
      
      // Event-Listener f√ºr Dashboard
      document.getElementById('stats-toggle-btn').addEventListener('click', toggleDashboard);
      document.getElementById('stats-close-btn').addEventListener('click', toggleDashboard);
    };
    
    // Zeigt Willkommensnachricht mit Lernfortschritt
    function showWelcomeMessage() {
      const stats = LearningManager.getBasicStats();
      
      // Aktualisiere das Progress Badge im Header
      updateProgressBadge();
      
      if (stats.totalAttempts === 0) {
        // Neuer User
        console.log('üéì BGA-Trainer Pro: Willkommen! Viel Erfolg beim Lernen.');
        return;
      }
      
      // Returning User - zeige Fortschritt
      const startDate = new Date(stats.startedAt);
      const daysSince = Math.floor((Date.now() - startDate.getTime()) / (1000 * 60 * 60 * 24));
      
      let message = `üéì Willkommen zur√ºck!\n\n`;
      message += `üìä Dein Fortschritt:\n`;
      message += `‚Ä¢ ${stats.totalAttempts} F√§lle bearbeitet\n`;
      message += `‚Ä¢ ${stats.correctAttempts} davon richtig (${stats.successRate}%)\n`;
      message += `‚Ä¢ ${stats.uniqueCasesWorked} verschiedene F√§lle ge√ºbt\n`;
      
      if (daysSince > 0) {
        message += `‚Ä¢ Seit ${daysSince} Tag${daysSince !== 1 ? 'en' : ''} dabei\n`;
      }
      
      if (stats.recentSessionSize > 0) {
        message += `\nüí™ In dieser Session: ${stats.recentSessionSize} Fall${stats.recentSessionSize !== 1 ? 'e' : ''} bearbeitet`;
      }
      
      console.log(message);
      
      // Optional: Zeige auch visuell im UI (dezent)
      // Das k√∂nnen wir in Sprint 2 ausbauen
    }
    
    // Aktualisiert das Progress Badge im Header
    function updateProgressBadge() {
      const stats = LearningManager.getBasicStats();
      const badge = document.getElementById('progress-badge');
      const text = document.getElementById('progress-text');
      
      if (stats.totalAttempts === 0) {
        text.textContent = 'üéØ Start';
        badge.title = 'Noch keine F√§lle bearbeitet. Viel Erfolg!';
      } else {
        text.textContent = `üìä ${stats.correctAttempts}/${stats.totalAttempts} (${stats.successRate}%)`;
        badge.title = `Fortschritt: ${stats.correctAttempts} von ${stats.totalAttempts} F√§llen richtig gel√∂st (${stats.successRate}%)\n${stats.uniqueCasesWorked} verschiedene F√§lle ge√ºbt\n\nKlicke f√ºr mehr Details`;
      }
      
      // Mache Badge klickbar f√ºr detaillierte Statistiken
      badge.style.cursor = 'pointer';
      badge.onclick = showDetailedStats;
    }
    
    // ========================================
    // SPRINT 2: Dashboard Funktionen
    // ========================================
    
    // Zeigt/versteckt das Dashboard
    function toggleDashboard() {
      const dashboard = document.getElementById('stats-dashboard');
      const isHidden = dashboard.classList.contains('hidden');
      
      if (isHidden) {
        const stats = LearningManager.getBasicStats();
        if (stats.totalAttempts === 0) {
          alert('üìä Noch keine Statistiken verf√ºgbar.\n\nBearbeite ein paar F√§lle und deine Fortschritte werden hier angezeigt!');
          return;
        }
        renderDashboard();
        dashboard.classList.remove('hidden');
        // Scroll zum Dashboard
        dashboard.scrollIntoView({ behavior: 'smooth', block: 'start' });
      } else {
        dashboard.classList.add('hidden');
      }
    }
    
    // Rendert das komplette Dashboard
    function renderDashboard() {
      const container = document.getElementById('stats-content');
      const stats = LearningManager.getBasicStats();
      
      let html = '';
      
      // Sektion 1: √úbersicht
      html += renderOverviewSection(stats);
      
      // Sektion 2: Performance nach St√∂rungstyp
      html += renderDisorderPerformance();
      
      // Sektion 3: Fehleranalyse
      html += renderErrorAnalysis();
      
      // Sektion 4: Trend-Analyse
      html += renderTrendAnalysis();
      
      // Sektion 5: Verwechslungsmuster
      html += renderConfusionPatterns();
      
      // Sektion 6: Empfehlungen
      html += renderRecommendations();
      
      container.innerHTML = html;
    }
    
    // Rendert die √úbersichts-Sektion
    function renderOverviewSection(stats) {
      const startDate = new Date(stats.startedAt);
      const daysSince = Math.floor((Date.now() - startDate.getTime()) / (1000 * 60 * 60 * 24));
      
      let html = '<div class="stats-section">';
      html += '<h3>üìà Gesamt√ºbersicht</h3>';
      html += '<div class="stats-grid">';
      
      html += '<div class="stat-item">';
      html += '<div class="stat-label">Bearbeitete F√§lle</div>';
      html += `<div class="stat-value">${stats.totalAttempts}</div>`;
      html += '</div>';
      
      html += '<div class="stat-item">';
      html += '<div class="stat-label">Erfolgsquote</div>';
      html += `<div class="stat-value">${stats.successRate}%</div>`;
      html += '</div>';
      
      html += '<div class="stat-item">';
      html += '<div class="stat-label">Verschiedene F√§lle</div>';
      html += `<div class="stat-value">${stats.uniqueCasesWorked}/${CASES.length}</div>`;
      html += '</div>';
      
      html += '<div class="stat-item">';
      html += '<div class="stat-label">Lernzeit</div>';
      html += `<div class="stat-value">${daysSince === 0 ? 'Heute' : daysSince + ' Tag' + (daysSince !== 1 ? 'e' : '')}</div>`;
      html += '</div>';
      
      html += '</div>'; // stats-grid
      html += '</div>'; // stats-section
      
      return html;
    }
    
    // Rendert Performance nach St√∂rungstyp
    function renderDisorderPerformance() {
      const performance = LearningManager.getPerformanceByDisorder();
      
      if (performance.length === 0) {
        return '';
      }
      
      let html = '<div class="stats-section">';
      html += '<h3>üéØ Performance nach St√∂rungstyp</h3>';
      
      performance.forEach(disorder => {
        html += `<div style="margin-bottom: 16px;">`;
        html += `<div style="display: flex; justify-content: space-between; margin-bottom: 4px;">`;
        html += `<span style="font-weight: 500;">${disorder.label}</span>`;
        html += `<span>${disorder.correct}/${disorder.total} (${disorder.percentage}%)</span>`;
        html += `</div>`;
        html += `<div class="progress-bar-container">`;
        html += `<div class="progress-bar ${disorder.status}" style="width: ${disorder.percentage}%">`;
        if (disorder.percentage > 20) {
          html += `${disorder.percentage}%`;
        }
        html += `</div>`;
        html += `</div>`;
        html += `</div>`;
      });
      
      html += '</div>';
      return html;
    }
    
    // Rendert Fehlertyp-Analyse
    function renderErrorAnalysis() {
      const errorAnalysis = LearningManager.getErrorTypeAnalysis();
      const stats = LearningManager.getBasicStats();
      
      if (stats.totalAttempts < 5) {
        return ''; // Zu wenig Daten
      }
      
      let html = '<div class="stats-section">';
      html += '<h3>üîç Fehleranalyse</h3>';
      
      html += '<div style="margin-bottom: 12px;">';
      html += `<p style="margin: 0 0 8px 0; font-size: 0.9rem;">Von ${errorAnalysis.totalErrors} Fehlern:</p>`;
      html += '<div class="stats-grid">';
      
      html += '<div class="stat-item">';
      html += '<div class="stat-label">Prim√§rst√∂rung falsch</div>';
      html += `<div class="stat-value">${errorAnalysis.primaryErrors}</div>`;
      html += `<div style="font-size: 0.75rem; opacity: 0.8;">${errorAnalysis.primaryErrorRate}% aller Versuche</div>`;
      html += '</div>';
      
      html += '<div class="stat-item">';
      html += '<div class="stat-label">Kompensation falsch</div>';
      html += `<div class="stat-value">${errorAnalysis.compensationErrors}</div>`;
      html += `<div style="font-size: 0.75rem; opacity: 0.8;">${errorAnalysis.compensationErrorRate}% aller Versuche</div>`;
      html += '</div>';
      
      html += '<div class="stat-item">';
      html += '<div class="stat-label">Beides falsch</div>';
      html += `<div class="stat-value">${errorAnalysis.bothErrors}</div>`;
      html += `<div style="font-size: 0.75rem; opacity: 0.8;">${errorAnalysis.bothErrorRate}% aller Versuche</div>`;
      html += '</div>';
      
      html += '</div>'; // stats-grid
      
      // Diagnose
      let diagnosis = '';
      if (errorAnalysis.mainWeakness === 'primary') {
        diagnosis = 'üí° <strong>Hauptschw√§che:</strong> Erkennung der Prim√§rst√∂rung. Tipp: Schau zuerst auf den pH-Wert, dann auf pCO‚ÇÇ und HCO‚ÇÉ‚Åª.';
      } else if (errorAnalysis.mainWeakness === 'compensation') {
        diagnosis = 'üí° <strong>Hauptschw√§che:</strong> Einsch√§tzung der Kompensation. Tipp: Ist der andere Parameter auch au√üerhalb der Norm? Dann liegt Kompensation vor.';
      } else if (errorAnalysis.mainWeakness === 'both') {
        diagnosis = 'üí° <strong>Hauptschw√§che:</strong> Grundlegendes BGA-Verst√§ndnis. Tipp: Arbeite die F√§lle Schritt f√ºr Schritt durch und nutze den Normwerte-Spickzettel.';
      } else {
        diagnosis = '‚úÖ <strong>Sehr gut!</strong> Du arbeitest pr√§zise und machst kaum Fehler.';
      }
      
      html += `<div style="margin-top: 12px; padding: 10px; background: rgba(255,255,255,0.2); border-radius: 6px; font-size: 0.85rem;">${diagnosis}</div>`;
      html += '</div>';
      
      html += '</div>';
      return html;
    }
    
    // Rendert Trend-Analyse
    function renderTrendAnalysis() {
      const trend = LearningManager.getTrendAnalysis();
      
      if (!trend.available) {
        return ''; // Zu wenig Daten
      }
      
      let html = '<div class="stats-section">';
      html += '<h3>üìä Lernkurve</h3>';
      
      let trendIcon = '';
      if (trend.trend === 'strong-improvement') trendIcon = 'üöÄ';
      else if (trend.trend === 'improvement') trendIcon = 'üìà';
      else if (trend.trend === 'stable') trendIcon = '‚û°Ô∏è';
      else trendIcon = 'üìâ';
      
      html += `<div style="text-align: center; padding: 16px;">`;
      html += `<div style="font-size: 2.5rem; margin-bottom: 8px;">${trendIcon}</div>`;
      html += `<div style="font-size: 1.1rem; font-weight: 600; margin-bottom: 8px;">${trend.message}</div>`;
      html += `<div style="display: flex; justify-content: center; gap: 32px; margin-top: 16px;">`;
      html += `<div>`;
      html += `<div style="font-size: 0.85rem; opacity: 0.9;">Erste H√§lfte</div>`;
      html += `<div style="font-size: 1.8rem; font-weight: 700;">${trend.firstHalfRate}%</div>`;
      html += `</div>`;
      html += `<div style="font-size: 2rem; align-self: center;">‚Üí</div>`;
      html += `<div>`;
      html += `<div style="font-size: 0.85rem; opacity: 0.9;">Zweite H√§lfte</div>`;
      html += `<div style="font-size: 1.8rem; font-weight: 700;">${trend.secondHalfRate}%</div>`;
      html += `</div>`;
      html += `</div>`;
      
      if (trend.improvement > 0) {
        html += `<div style="margin-top: 12px; font-size: 0.9rem; color: #10b981;">‚ñ≤ +${trend.improvement} Prozentpunkte Verbesserung</div>`;
      } else if (trend.improvement < 0) {
        html += `<div style="margin-top: 12px; font-size: 0.9rem; color: #fbbf24;">‚ñº ${trend.improvement} Prozentpunkte</div>`;
      }
      
      html += `</div>`;
      html += '</div>';
      
      return html;
    }
    
    // Rendert Verwechslungsmuster
    function renderConfusionPatterns() {
      const patterns = LearningManager.getConfusionPatterns();
      
      if (patterns.length === 0) {
        return ''; // Keine systematischen Verwechslungen
      }
      
      let html = '<div class="stats-section">';
      html += '<h3>üîÑ H√§ufige Verwechslungen</h3>';
      html += `<p style="margin: 0 0 12px 0; font-size: 0.85rem; opacity: 0.9;">Diese St√∂rungen verwechselst du √∂fter:</p>`;
      
      patterns.forEach(pattern => {
        html += `<div style="background: rgba(255,255,255,0.15); padding: 10px; border-radius: 6px; margin-bottom: 8px; font-size: 0.85rem;">`;
        html += `<div style="font-weight: 600;">${getLabel(pattern.correct)} ‚Üí ${getLabel(pattern.selected)}</div>`;
        html += `<div style="opacity: 0.9;">${pattern.count}√ó verwechselt</div>`;
        html += `</div>`;
      });
      
      html += '</div>';
      return html;
    }
    
    // Rendert Empfehlungen
    function renderRecommendations() {
      const recommendations = LearningManager.getRecommendedCases();
      
      if (recommendations.length === 0) {
        return '';
      }
      
      let html = '<div class="stats-section">';
      html += '<h3>üí° Empfehlungen f√ºr dich</h3>';
      
      recommendations.forEach(rec => {
        html += '<div class="recommendation-card">';
        html += `<h4>${rec.title}</h4>`;
        html += `<p>${rec.description}</p>`;
        html += '</div>';
      });
      
      html += '</div>';
      return html;
    }
    
    // Zeigt detaillierte Statistiken in einem Modal/Alert
    function showDetailedStats() {
      const stats = LearningManager.getBasicStats();
      
      if (stats.totalAttempts === 0) {
        alert('üìä Noch keine Statistiken verf√ºgbar.\n\nBearbeite ein paar F√§lle und deine Fortschritte werden hier angezeigt!');
        return;
      }
      
      const startDate = new Date(stats.startedAt);
      const daysSince = Math.floor((Date.now() - startDate.getTime()) / (1000 * 60 * 60 * 24));
      
      let message = `üìä DEINE LERNSTATISTIKEN\n`;
      message += `${'='.repeat(40)}\n\n`;
      
      message += `üìà Gesamtfortschritt:\n`;
      message += `   ‚Ä¢ Bearbeitete F√§lle: ${stats.totalAttempts}\n`;
      message += `   ‚Ä¢ Richtig gel√∂st: ${stats.correctAttempts}\n`;
      message += `   ‚Ä¢ Erfolgsquote: ${stats.successRate}%\n`;
      message += `   ‚Ä¢ Verschiedene F√§lle: ${stats.uniqueCasesWorked} von ${CASES.length}\n\n`;
      
      message += `‚è±Ô∏è Zeitraum:\n`;
      if (daysSince === 0) {
        message += `   ‚Ä¢ Heute gestartet\n`;
      } else {
        message += `   ‚Ä¢ Seit ${daysSince} Tag${daysSince !== 1 ? 'en' : ''} dabei\n`;
      }
      
      if (stats.recentSessionSize > 0) {
        message += `   ‚Ä¢ Aktuelle Session: ${stats.recentSessionSize} Fall${stats.recentSessionSize !== 1 ? 'e' : ''}\n`;
      }
      
      message += `\n`;
      
      // Motivierende Nachricht basierend auf Performance
      if (stats.successRate >= 80) {
        message += `üåü Hervorragend! Du beherrschst die BGA-Analyse sehr gut.\n`;
      } else if (stats.successRate >= 60) {
        message += `üëç Gut gemacht! Du machst solide Fortschritte.\n`;
      } else if (stats.successRate >= 40) {
        message += `üí™ Bleib dran! Mit mehr √úbung wirst du sicherer.\n`;
      } else if (stats.totalAttempts < 10) {
        message += `üéØ Du bist am Anfang. Jeder Fall macht dich besser!\n`;
      } else {
        message += `üìö Tipp: Schau dir die Normwerte an und analysiere Schritt f√ºr Schritt.\n`;
      }
      
      // In Sprint 2 werden wir hier detailliertere Analysen zeigen
      message += `\nüí° Detaillierte Fehleranalyse kommt bald!`;
      
      alert(message);
    }
  </script>

</body>
</html>